#restringir contagem para duas variaveis (region, zone), FORMATO LARGO
cr |>
count(region, zone)
library(janitor)
# para descrever um conjunto, FORMATO LONGO
cr |>
tabyl(region, zone)
# se inverte zona por region fica no formato largo
cr |>
tabyl(zone, region)
cr |>
tabyl(cultivar, farm_management)
cr |>
count(farm_management, cultivar) |>
ggplot(aes(cultivar, n, fill = farm_management)) +
geom_col(position = "stack")
#para desemplilhar e colocar uma barra ao lado da outra
cr |>
count(farm_management, cultivar) |>
ggplot(aes(cultivar, n, fill = farm_management, label = n)) +
geom_col(position = "dodge2") +
scale_fill_colorblind()+
theme_bw()+
theme(strip.text.x = element_blank())+
facet_wrap(~cultivar, scales = "free") +
geom_text(position = position_dodge (width = 0.9))+
facet_wrap(~cultivar, scales = "free_x" )
library(gsheet)
library(tidyverse)
mg <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1aID5Dh6PlBVCKzU1j7k-WA6zuWQWE2NhtWEgdJtt5iA/edit?usp=sharing")
library(gsheet)
library(tidyverse)
mg <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1aID5Dh6PlBVCKzU1j7k-WA6zuWQWE2NhtWEgdJtt5iA/edit?usp=sharing")
library(gsheet)
library(tidyverse)
mg <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1aID5Dh6PlBVCKzU1j7k-WA6zuWQWE2NhtWEgdJtt5iA/edit?usp=sharing")
library(gsheet)
library(tidyverse)
mg <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1aID5Dh6PlBVCKzU1j7k-WA6zuWQWE2NhtWEgdJtt5iA/edit?usp=sharing")
mg <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1aID5Dh6PlBVCKzU1j7k-WA6zuWQWE2NhtWEgdJtt5iA/edit?usp=sharing")
library(gsheet)
library(tidyverse)
mg <- gsheet2tbl ("https://docs.google.com/spreadsheets/d/1aID5Dh6PlBVCKzU1j7k-WA6zuWQWE2NhtWEgdJtt5iA/edit?usp=sharing")
library(gsheet)
library(tidyverse)
mg <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1aID5Dh6PlBVCKzU1j7k-WA6zuWQWE2NhtWEgdJtt5iA/edit?usp=sharing")
library(gsheet)
library(tidyverse)
mg <- gsheet2tbl ("https://docs.google.com/spreadsheets/d/1aID5Dh6PlBVCKzU1j7k-WA6zuWQWE2NhtWEgdJtt5iA/edit?usp=sharing")
milho <- milho |>
mutate(block = as.factor(block))
mix2 <- lmer(sqrt(index) ~ hybrid*method + block + (1|block/hybrid), data = milho)
anova (mix2)
#No fator aleatório, colocamos o hibrido dentro do bloco. ( 1 | block/hybrid); Comparamos os híbridos nas linhas e os métodos nas colunas.
check_normality(mix2)
check_heteroscedasticity(mix2)
anova (mix2)
mix <- lmer(index ~ hybrid*method + block + (1|block/hybrid),
data = milho)
anova (mix2)
anova (mix2)
check_normality(mix3)
check_heteroscedasticity(mix3)
#demonstram que os dados possuem normalidade na distribuição dos resíduos, no entanto, não há homogeneidade de variância entre os grupos. Portanto, também será preciso realizar transformação.
wm <- WhiteMoldSoybean
wm |>
ggplot(aes(inc, yld))+
geom_point()+
facet_wrap(~ study)+
theme_minimal()+
geom_smooth(method = "lm", se = F)
#Predizer uma resposta em relação à outra. Duas respostas numéricas contínuas, ajustanto o modelo linear ou não. Muitos estudos diferentes, gráfico geral. A saída dos gráficos mostra que com a ação do fungicida e redução da severidade acontece um incremento de produtividade da soja.
fit_all |>
filter(term == "(intercept)") |>
ggplot(aes(x = estimate))+
geom_histogram(bins = 8, color = "white", fill = "gray50")+
theme_r4pde()+
labs(x = "slope", y = "frequency")
library(patchwork)
mofo2 <- wm |>
group_by(study) |>
do(tidy(lm(.$yld ~ .$inc), conf.int = TRUE))
mofo2
mofo2 <- wm |>
group_by(study) |>
do(tidy(lm(.$yld ~ .$inc), conf.int = TRUE))
mofo2
mofo2 <- wm |>
group_by(study) |>
do(tidy(lm(.$yld ~ .$inc), conf.int = TRUE))
mofo2
df<- mofo2 |>
filter(term == ".$inc")
mean(df$estimate)
#Histograma da produtividade quando incidência é 0
library(cowplot)
p1 <- mofo2 |>
filter(term == "(Intercept)") |>
ggplot(aes(x = estimate))+
geom_histogram(bins = 8, color = "white", fill = "gray")+
theme_r4pde()+
labs(x = "Intercept", y = "frequency")
p2 <- mofo2 |>
filter(term == ".$inc") |>
ggplot(aes(x = estimate))+
geom_histogram(bins = 8, color = "white", fill = "gray")+
theme_r4pde()+
labs(x = "Slopes", y = "frequency")
library(patchwork)
p1+p2
#Modelo misto
mofo3 <- lmer(yld ~ inc + (inc | study), data = wm,
REML = F)
summary(mofo3)
library(lme4)
mofo3 <- lmer(yld ~ inc + (inc|study), data = wm, REML = F)
summary(mofo3)
Anova(mofo3)
Anova(mofo3)
library(lme4)
mofo3 <- lmer(yld ~ inc + (inc|study), data = wm, REML = F)
summary(mofo3)
Anova(mofo3)
#pacotes
library(tidyverse)
library(patchwork)
library(AgroR)
library(corrplot)
Anova(mofo3)
wm <- WhiteMoldSoybean
wm |>
ggplot(aes(inc, yld)) +
geom_point() +
#facet_wrap(~ study) +
theme_minimal() +
geom_smooth(method = 'lm', se = T)
mofo1 <-  lm(yld ~ inc, data = wm)
summary(mofo1)
fit_all <- wm |>
group_by(study) |>
do(tidy(lm(.$yld ~ .$inc), conf.int = T))
fit_all
fit_all.interc <- fit_all |>
filter(term == "(Intercept)")
p1 <- fit_all.interc |>
ggplot(aes(x = estimate)) +
geom_histogram(bins = 8) +
theme_clean() +
labs(x = 'Intercept')
fit_all.inc <- fit_all |>
filter(term == ".$inc")
p2 <- fit_all.inc |>
ggplot(aes(x = estimate)) +
geom_histogram(bins = 8) +
theme_clean() +
labs(x = 'Incidence')
p1 + p2
mofo3 <-  lmer(yld ~ inc + (inc|study), data = wm, REML = F)
summary(mofo3)
mofo3 <-  lmer(yld ~ inc + (inc|study), data = wm, REML = F)
summary(mofo3)
Anova(mofo3) # para obter o valor p
Anova(mofo3) # para obter o valor p
library(gsheet)
library(tidyverse)
library(lme4)
library(performance)
library(DHARMa)
library(emmeans)
library(multcomp)
library(r4pde)
library(drc)
Anova(mofo3) # para obter o valor p
#pacotes
library(tidyverse)
library(patchwork)
library(AgroR)
library(corrplot)
Anova(mofo3) # para obter o valor p
library(gsheet)
library(tidyverse)
library(lme4)
library(performance)
library(DHARMa)
library(emmeans)
library(multcomp)
library(r4pde)
library(drc)
library(stats)
library(gsheet)
library(tidyverse)
library(lme4)
library(performance)
library(DHARMa)
library(emmeans)
library(multcomp)
library(r4pde)
library(drc)
library(stats)
Anova(mofo3) # para obter o valor p
Anova(mofo3) # para obter o valor p
mofo1 <-  lmer(yld ~ inc + (inc|study), data = wm, REML = F)
summary(mofo3)
Anova(mofo1) # para obter o valor p
Anova(mofo1) # para obter o valor p
confint(mofo3, method = "Wald")
confint(mofo3, method = "Wald")
library(gsheet)
library(tidyverse)
library(lme4)
library(performance)
library(DHARMa)
library(emmeans)
library(multcomp)
library(r4pde)
library(drc)
library(stats)
imgs <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=373270992")
imgs1 <- imgs|>
ggplot(aes(Assess, LeafDoctor))+
geom_point()+ geom_smooth(method = "lm")
imgs2 <- imgs|>
ggplot(aes(Assess, ImageJ))+
geom_point()+geom_smooth(method = "lm")
imgs3 <- imgs |>
ggplot(aes(LeafDoctor, ImageJ))+
geom_point()+geom_smooth(method = "lm")
estande <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=401662555")
estande |>
ggplot(aes(trat, nplants, color = factor (exp))) +
geom_boxplot() +
facet_wrap(~ exp) +
theme_bw() +
stat_summary(fun.data = "mean_cl_boot", size = 0.5,
color = "black")
estande |>
ggplot(aes(trat, nplants, color = factor (exp))) +
geom_boxplot() +
facet_wrap(~ exp) +
theme_bw() +
stat_summary(fun.data = "mean_cl_boot", size = 0.5,
color = "black")
estande |>
ggplot(aes(trat, nplants, color = factor (exp))) +
geom_jitter(width = 0.1, alpha = 0.2) +
facet_wrap(~exp) +
theme_bw() +
stat_summary(fun.data = "mean_cl_boot", size = 0.5,
color = "black") +
geom_smooth(method = "lm", se = F)
exp2 <- estande |>
filter (exp == 2)
exp2 |>
ggplot(aes(trat, nplants)) +
geom_point() +
ylim(0,100) +
geom_smooth(method = "lm", se = F, formula = y ~poly(x,2), color = "black") +
geom_smooth(method = "lm",
se = FALSE)
#MODELO LINEAR
exp2$trat2 <- exp2$trat^2
#primeira ordem
lm2 <- lm(nplants ~ trat,
data = exp2)
summary(lm2)
hist(residuals(lm2))
#segunda ordem
lm3 <- lm(nplants ~ trat + trat2,
data = exp2)
summary(lm3)
hist(residuals(lm3))
hist(residuals(lm3))
AIC(lm2)
AIC(lm3)
library(AgroR)
with(exp2, polynomial(trat, nplants, grau = 3))
pyra2 <- pyra |>
group_by(code, dose) |>
summarise(mean_germination = mean(germination))
library(drc)
isolado186 <- pyra2 |>
filter(code == "186")
drc1 <- drm(mean_germination ~ dose, data = isolado186,
fct = LL.3())
AIC(drc1)
plot(drc1)
ED(drc1, 50, interval = "delta")
ED(drc1, 50, interval = "delta")
summary(drc1)
df_ec50 <- estimate_EC50(mean_germination ~ dose,
data = sens2,
isolate_col = "code",
interval = "delta",
fct = drc :: LL.3())
library(ec50estimator)
library(ec50estimator)
df_ec50 <- estimate_EC50(mean_germination ~ dose,
data = sens2,
isolate_col = "code",
interval = "delta",
fct = drc :: LL.3())
library(ec50estimator)
df_ec50 <- estimate_EC50(mean_germination ~ dose,
data = pyra2,
isolate_col = "code",
interval = "delta",
fct = drc::LL.3())
df_ec50 |>
ggplot(aes(reorder(ID, Estimate), Estimate)) +
geom_point() +
geom_errorbar(aes(ymin = Lower, ymax= Upper), width = 0.1) +
coord_flip()
library(ec50estimator) #Permite estimar o ec50 de todos os isolados ao mesmo tempo
df_ec50 <- estimate_EC50(mean_germination ~ dose,
data = pyra2,
isolate_col = "code",
interval = "delta",
fct = drc::LL.3())
df_ec50
#Se a ec50 for maior, menos sensível é o isolado (nesse caso ao fungicida)
df_ec50 |>
ggplot(aes(reorder(ID, Estimate), Estimate))+
geom_point()+
geom_errorbar(aes(ymin = Lower, ymax = Upper))+
coord_flip()
df_ec50 %>%
ggplot(aes(reorder(ID, Estimate), Estimate))+
geom_point()+
geom_errorbar(aes(ymin = Lower,
ymax = Upper),
width = 0.1)+
ylim (0, 1.2)+
coord_flip()
library(ec50estimator)
df_ec50 <- estimate_EC50(mean_germination ~ dose,
data = pyra2,
isolate_col = "code",
interval = "delta",
fct = drc::LL.3())
df_ec50 |>
ggplot(aes(reorder(ID, Estimate), Estimate))+
geom_point()+
geom_errorbar(aes(ymin = Lower,
ymax = Upper),
width = 0.1)+
ylim (0, 1.2)+
coord_flip()
library(ec50estimator)
df_ec50 <- estimate_EC50(mean_germ~dose,
data = fung2,
isolate_col = "code",
interval = "delta",
fct = drc::LL.3())
library(ec50estimator)
df_ec50 <- estimate_EC50(mean_germ~dose,
data = fung2,
isolate_col = "code",
interval = "delta",
fct = drc::LL.3())
library(ec50estimator)
df_ec50 <- estimate_EC50(mean_germ~dose,
data = fung2,
isolate_col = "code",
interval = "delta",
fct = drc::LL.3())
library(ec50estimator)
df_ec50 <- estimate_EC50(mean_germ~dose,
data = fung2,
isolate_col = "code",
interval = "delta",
fct = drc::LL.3())
library(ec50estimator)
df_ec50 <- estimate_EC50(mean_germ~dose,
data = fung2,
isolate_col = "code",
interval = "delta",
fct = drc::LL.3())
library(ec50estimator)
df_ec50 <- estimate_EC50(mean_germination ~ dose,
data = pyra2,
isolate_col = "code",
interval = "delta",
fct = drc::LL.3())
df_ec50 %>%
ggplot(aes(reorder(ID, Estimate), Estimate))+
geom_point()+
geom_errorbar(aes(ymin = Lower,
ymax = Upper),
width = 0.1)+
ylim (0, 1.2)+
coord_flip()
library(ec50estimator)
df_ec50 <- estimate_EC50(mean_germ~dose,
data = fung2,
isolate_col = "code",
interval = "delta",
fct = drc::LL.3())
anova (mix2)
anova (mix2)
anova (mix2)
milho <- milho |>
mutate(block = as.factor(block))
mix <- lmer(index ~ hybrid*method + block + (1|block/hybrid),
data = milho)
anova (mix2)
#No fator aleatório, colocamos o hibrido dentro do bloco. ( 1 | block/hybrid); Comparamos os híbridos nas linhas e os métodos nas colunas.
milho <- milho |>
mutate(block = as.factor(block))
mix <- lmer(index ~ hybrid*method + block + (1|block/hybrid),
data = milho)
anova (mix2)
#No fator aleatório, colocamos o hibrido dentro do bloco. ( 1 | block/hybrid); Comparamos os híbridos nas linhas e os métodos nas colunas.
milho <- milho |>
mutate(block = as.factor(block))
mix2 <- lmer(index ~ hybrid*method + block + (1|block/hybrid),
data = milho)
anova (mix2)
#No fator aleatório, colocamos o hibrido dentro do bloco. ( 1 | block/hybrid); Comparamos os híbridos nas linhas e os métodos nas colunas.
anova (mix2)
fit_all <- wm |>
group_by(study) |>
do(tidy(lm(.$yld ~ .$inc), conf.int = T))
fit_all
fit_all <- wm |>
group_by(study) |>
do(tidy(lm(.$yld ~ .$inc), conf.int = T))
fit_all
fit_all.interc <- fit_all |>
filter(term == "(Intercept)")
p1 <- fit_all.interc |>
ggplot(aes(x = estimate)) +
geom_histogram(bins = 8) +
theme_clean() +
labs(x = 'Intercept')
fit_all.inc <- fit_all |>
filter(term == ".$inc")
p2 <- fit_all.inc |>
ggplot(aes(x = estimate)) +
geom_histogram(bins = 8) +
theme_clean() +
labs(x = 'Incidence')
p1 + p2
wm <- WhiteMoldSoybean
wm |>
ggplot(aes(inc, yld)) +
geom_point() +
#facet_wrap(~ study) +
theme_minimal() +
geom_smooth(method = 'lm', se = T)
mofo1 <-  lm(yld ~ inc, data = wm)
summary(mofo1)
mofo1 <-  lm(yld ~ inc, data = wm)
summary(mofo1)
mofo1 <-  lm(yld ~ inc, data = wm)
summary(mofo1)
mofo1 <-  lm(yld ~ inc, data = wm)
summary(mofo1)
mofo1 <-  lm(yld ~ inc, data = wm)
summary(mofo1)
fit_all <- wm |>
group_by(study) |>
do(tidy(lm(.$yld ~ .$inc), conf.int = T))
fit_all
mofo1 <-  lm(yld ~ inc, data = wm)
summary(mofo1)
mofo1 <-  lmer(yld ~ inc + (inc|study), data = wm, REML = F)
summary(mofo3)
mofo1 <- lm(yld ~ inc,
data = wm)
#intercepto pordutividade quando a incidencia é zero, inc é o slope com 10% de incidencia esta perdendo 90kg.
summary(mofo1)
#O 3299 é a produtividade por ha quando não há controle. O 9,261 indica a redução de produtividade em kg/ha de acordo com o aumento da severidade.
wm |>
ggplot(aes(inc, yld, group = factor(study)))+
geom_point()+
#facet_wrap(~ study)+
theme_minimal()+
geom_smooth(method = "lm", se = F)
mofo1 <- lm(yld ~ inc,
data = wm)
summary(mofo1)
#Código muito importante para agrupar vários experimentos. Já detalha as médias para cada variável resposta.
wm |>
ggplot(aes(inc, yld, group = factor(study)))+
geom_point()+
#facet_wrap(~ study)+
theme_minimal()+
geom_smooth(method = "lm", se = F)
mofo1 <- lm(yld ~ inc,
data = wm)
summary(mofo1)
#Código muito importante para agrupar vários experimentos. Já detalha as médias para cada variável resposta.
wm |>
ggplot(aes(inc, yld, group = factor(study)))+
geom_point()+
#facet_wrap(~ study)+
theme_minimal()+
geom_smooth(method = "lm", se = F)
mofo1 <- lm(yld ~ inc,
data = wm)
summary(mofo1)
#Código muito importante para agrupar vários experimentos. Já detalha as médias para cada variável resposta.
wm |>
ggplot(aes(inc, yld, group = factor(study)))+
geom_point()+
#facet_wrap(~ study)+
theme_minimal()+
geom_smooth(method = "lm", se = F)
mofo1 <- lm(yld ~ inc,
data = wm)
summary(mofo1)
#Código muito importante para agrupar vários experimentos. Já detalha as médias para cada variável resposta.
