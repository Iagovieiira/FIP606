#rejeita
#ipotese nula é que as médias são iguais o que demonstra que rejeita - com 3 grupos ou mais
m3 <- kruskal(inseticida$count,
inceticida$spray,
group = TRUE)
m3
#da a media dos tratamentos e um ranking para fazer a estatistica, calculando os agrupamentos. 3 grupos ranqueados. o não parametrico deu o mesmo resultado que o modelo transformado. podendo partir para a alternativa 3 assumindo que a distribuição é de acordo com os dados podendo ser poason (modelo linear generalizado - mais moderno)
m4 <- glm(count ~ spray,
family = poisson, data = inseticida)
summary(m4)
anova(m4)
library(car)
Anova(m4)
plot(simulateResiduals(m4))
m4_medias <- emmeans(m4, ~spray,
type = "response")
cld(m4_medias)
library(MASS)
b <- boxcox(lm(inceticida$count+0.1 ~1))
lambda <- b$x[which.max(b$y)]
lambda
inceticida$count3 <- (inceticida$count ^  lambda - 1) / lambda
inceticida$count3
#mandeira de tranformar
li <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=2023059672")
#pacotes carregados
library(tidyverse)
library(gsheet)
#Importar pacotes
mg <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=983033137")
#vizualização
mg |>
ggplot(aes(trat, comp))+
geom_boxplot()
#demonstra o efeito da suplementação de magnesio que induz a resistencia, visando testar uma hipotese cientifica é que com a suplementação induz a resistencia
#a hipotese nula é que o valor das populações são iguais.
#teste T
#longo para o largo (ver o formato antes tem que larogo)
mg2 <- mg |>
pivot_wider(names_from = trat,
values_from = comp)
teste1 <- t.test(mg2$Mg2, mg2$control, )
#interpretação: o teste T - ligado ao erro padrão, a probabilidade é pequena pelo fato do p valor ter dado p-value = 2.423e-07 que nesse caso é menor que 0.5 rejeitando a hipotese nula. conclunido que o teste t esta correto. o intervalo de confiança é a diferença verdadeira entre as médias, dado pela ordem de montagem do teste.
#testar a normalidade
shapiro.test(mg2$control)
#testar a normalidade hipotese nula, dizendo que a distribuição é normal, maior que 0.5 normalidade.
hist(mg2$control)
#faz-se o histograma para saber se é normal
#testar a normalidade para mg
shapiro.test(mg2$Mg2)
#demosnta uma distribuição normal acima de 0.5
hist(mg2$Mg2)
#teste F que compara duas variancias
var.test(mg2$control, mg2$Mg2)
qqnorm(mg2$control)
qqline(mg2$control)
library(report)
report(teste1)
#para dois grupos test t, vai usar o test t pareado
#importar o pacote de dados:
escala <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1729131173")
library(dplyr)
escala2 <- escala |>
select(assessment, rater, acuracia) |>
pivot_wider(names_from = assessment,
values_from = acuracia)
#pacotes carregados
library(tidyverse)
library(gsheet)
#Importar pacotes
mg <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=983033137")
#vizualização
mg |>
ggplot(aes(trat, comp))+
geom_boxplot()
#demonstra o efeito da suplementação de magnesio que induz a resistencia, visando testar uma hipotese cientifica é que com a suplementação induz a resistencia
#a hipotese nula é que o valor das populações são iguais.
#teste T
#longo para o largo (ver o formato antes tem que larogo)
mg2 <- mg |>
pivot_wider(names_from = trat,
values_from = comp)
teste1 <- t.test(mg2$Mg2, mg2$control, )
#interpretação: o teste T - ligado ao erro padrão, a probabilidade é pequena pelo fato do p valor ter dado p-value = 2.423e-07 que nesse caso é menor que 0.5 rejeitando a hipotese nula. conclunido que o teste t esta correto. o intervalo de confiança é a diferença verdadeira entre as médias, dado pela ordem de montagem do teste.
#testar a normalidade
shapiro.test(mg2$control)
#testar a normalidade hipotese nula, dizendo que a distribuição é normal, maior que 0.5 normalidade.
hist(mg2$control)
#faz-se o histograma para saber se é normal
#testar a normalidade para mg
shapiro.test(mg2$Mg2)
#demosnta uma distribuição normal acima de 0.5
hist(mg2$Mg2)
#teste F que compara duas variancias
var.test(mg2$control, mg2$Mg2)
qqnorm(mg2$control)
qqline(mg2$control)
library(report)
report(teste1)
#para dois grupos test t, vai usar o test t pareado
#importar o pacote de dados:
escala <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1729131173")
library(dplyr)
escala2 <- escala |>
select(assessment, rater, acuracia) |>
pivot_wider(names_from = assessment,
values_from = acuracia)
m4_medias <- emmeans(m4, ~spray,
type = "response")
cld(m4_medias)
library(MASS)
b <- boxcox(lm(inceticida$count+0.1 ~1))
lambda <- b$x[which.max(b$y)]
lambda
inceticida$count3 <- (inceticida$count ^  lambda - 1) / lambda
inceticida$count3
#mandeira de tranformar
li <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=2023059672")
li |>
ggplot(aes(factor(dose), severity, color = factor(dose)))+
geom_jitter(whidth = 0.1)+
facet_wrap(~treat)
mf <- lm(severity ~ treat * dose,
data = li)
mf
anova(mf)
#demostra que a interassão é significativa, as doses estão diretamente ligadas aos tratamentos.
plot(simulateResiduals(mf))
#não teve problema
mf_medias <-   (mf, ~ treat | dose)
mf_medias <- (mf, ~ treat | dose)
mf_medias <- (mf ~ treat | dose)
cld (mf_medias)
library(multcomp)
library(multcompView)
mf_medias <- (mf ~ treat | dose)
cld (mf_medias)
mf_medias <- (mf ~ treat | dose)
#cld (mf_medias)
#comparou coluna
# comprar as linhas
mf_medias <- emmeans(mf, ~ dose | treat)
cld (mf_medias)
mf_medias <- (mf, ~ treat | dose)
mf_medias <- (mf, ~ treat | dose)
mf_medias <- (mf ~ treat | dose)
cld(mf_medias)
mf_medias <- (mf ~ treat | dose)
#cld(mf_medias)
#comparou coluna
library(dplyr)
escala2 <- escala |>
select(assessment, rater, acuracia) |>
pivot_wider(names_from = assessment,
values_from = acuracia)
library(dplyr)
escala2 <- escala |>
dplyr::select(assessment, rater, acuracia) |>
pivot_wider(names_from = assessment,
values_from = acuracia)
escala2
library(gsheet)
library(tidyverse)
library(lme4)
library(performance)
library(DHARMa)
library(emmeans)
library(multcomp)
library(r4pde)
library(drc)
library(gsheet)
library(tidyverse)
library(lme4)
library(performance)
library(DHARMa)
library(emmeans)
library(multcomp)
library(r4pde)
library(drc)
milho <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1345524759")
milho |>
ggplot(aes(method,index))+
geom_jitter(which = 0.1, alpha = 0.2)+
facet_wrap(~ hybrid)+
stat_summary(fun.data = "mean_cl_boot", size = 0.5, color = "blue")
milho <- milho |>
mutate(block = as.factor(block))
mix2 <- lmer(sqrt(index) ~ hybrid*method + block + (1|block/hybrid), data = milho)
anova (mix2)
check_normality(mix2)
check_heteroscedasticity(mix2)
plot(simulateResiduals(mix2))
qqnorm(residuals(mix2))
qqline(residuals(mix2))
hist(residuals(mix2))
medias_milho <- emmeans(mix2,
~ hybrid | method,
type = "response")
medias_milho
medias_milho2 <- emmeans(mix2,
~ method | hybrid,
type = "response")
medias_milho2
cld(medias_milho2, Letters = LETTERS)
mix3 <- lmer(sqrt(index) ~ hybrid*method + block + (1|block/hybrid), data = milho)
anova (mix3)
check_normality(mix3)
check_heteroscedasticity(mix3)
estande <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=401662555")
estande |>
ggplot(aes(trat, nplants))+
geom_jitter(which = 0.1, alpha = 0.3)+
facet_wrap(~ exp)+
stat_summary(fun.data = "mean_cl_boot", size = 0.5, color = "black")+
geom_smooth(method = "lm", se = F)
exp1 <- estande |>
filter(exp == 1)
exp1 |>
ggplot(aes(trat, nplants))+
geom_point()+
geom_smooth(se = F)
#MODELO LINEAR
lm1 = lm(nplants ~ trat,
data = exp1)
summary (lm1)
exp2 <- estande |>
filter(exp == 2)
exp2 |>
ggplot(aes(trat, nplants))+
geom_point()+
geom_smooth(se = F, method = "lm",
formula = y~poly(x,2),
color = "red")+
geom_smooth(method = "lm", se = FALSE)
#Modelo de primeira ordem
lm2 <- lm(nplants~trat,
data = exp2)
summary(lm2)
hist(residuals(lm2))
# Nodelo de segunda ordem
exp2$trat2 <- exp2$trat^2
exp3 <- estande |>
filter(exp == 3)
exp3 |>
ggplot(aes(trat, nplants))+
geom_point()+
geom_smooth(se = F) #method = "lm")
lm3 <- lm(nplants~trat + trat2,
data = exp2)
summary(lm3)
hist(residuals(lm3))
glm2 <- glm(nplants ~ trat, family = "gaussian", data = exp2)
glm2 <- glm(nplants ~ trat, family = "gaussian", data = exp2)
glm2 <- glm(nplants ~ trat, family = gaussian, data = exp2)
glm2 <- glm(nplants ~ trat, family = "gaussian", data = exp2)
glm2 <- glm(nplants ~ trat, family = "gaussian", data = exp2)
glm2 <- glm(nplants ~ trat, family = "gaussian", data = exp2)
glm2 <- glm(nplants ~ trat, family = "gaussian", data = exp2)
glm2 <- glm(nplants ~ trat, family = "gaussian", data = exp2)
glm2 <- glm(nplants ~ trat, family = "gaussian", data = exp2)
glm2 <- glm(nplants ~ trat, family = "gaussian", data = exp2)
library(gsheet)
library(tidyverse)
library(lme4)
library(performance)
library(DHARMa)
library(emmeans)
library(multcomp)
library(r4pde)
library(drc)
glm2 <- glm(nplants ~ trat, family = "gaussian", data = exp2)
glm2b <- glm(nplants ~ trat, family = "poison", data  = exp2)
glm2b <- glm(nplants ~ trat, family = "poisson", data  = exp2)
summary(glm2)
summary(glm2b)
glm2 <- glm(nplants ~ trat, family = "gaussian", data = exp2)
glm2 <- glm(nplants ~ trat, family = "gaussian", data = exp2)
exp2
glm2 <- glm(nplants ~ trat, family = gaussian(link = "identity") , data = exp2)
glm2 <- glm(nplants ~ trat, family = gaussian, data = exp2)
library(gsheet)
library(tidyverse)
library(lme4)
library(performance)
library(DHARMa)
library(emmeans)
library(multcomp)
library(r4pde)
library(drc)
milho <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1345524759")
milho |>
ggplot(aes(method,index))+
geom_jitter(which = 0.1, alpha = 0.2)+
facet_wrap(~ hybrid)+
stat_summary(fun.data = "mean_cl_boot", size = 0.5, color = "blue")
milho <- milho |>
mutate(block = as.factor(block))
mix2 <- lmer(sqrt(index) ~ hybrid*method + block + (1|block/hybrid), data = milho)
anova (mix2)
check_normality(mix2)
check_heteroscedasticity(mix2)
plot(simulateResiduals(mix2))
qqnorm(residuals(mix2))
qqline(residuals(mix2))
hist(residuals(mix2))
medias_milho <- emmeans(mix2,
~ hybrid | method,
type = "response")
medias_milho
medias_milho2 <- emmeans(mix2,
~ method | hybrid,
type = "response")
medias_milho2
cld(medias_milho2, Letters = LETTERS)
mix3 <- lmer(sqrt(index) ~ hybrid*method + block + (1|block/hybrid), data = milho)
anova (mix3)
check_normality(mix3)
check_heteroscedasticity(mix3)
estande <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=401662555")
estande |>
ggplot(aes(trat, nplants))+
geom_jitter(which = 0.1, alpha = 0.3)+
facet_wrap(~ exp)+
stat_summary(fun.data = "mean_cl_boot", size = 0.5, color = "black")+
geom_smooth(method = "lm", se = F)
exp1 <- estande |>
filter(exp == 1)
exp1 |>
ggplot(aes(trat, nplants))+
geom_point()+
geom_smooth(se = F)
#MODELO LINEAR
lm1 = lm(nplants ~ trat,
data = exp1)
summary (lm1)
exp2 <- estande |>
filter(exp == 2)
exp2 |>
ggplot(aes(trat, nplants))+
geom_point()+
geom_smooth(se = F, method = "lm",
formula = y~poly(x,2),
color = "red")+
geom_smooth(method = "lm", se = FALSE)
#Modelo de primeira ordem
lm2 <- lm(nplants~trat,
data = exp2)
summary(lm2)
hist(residuals(lm2))
# Nodelo de segunda ordem
exp2$trat2 <- exp2$trat^2
exp3 <- estande |>
filter(exp == 3)
exp3 |>
ggplot(aes(trat, nplants))+
geom_point()+
geom_smooth(se = F) #method = "lm")
lm3 <- lm(nplants~trat + trat2,
data = exp2)
summary(lm3)
hist(residuals(lm3))
glm2 <- glm(nplants ~ trat, family = gaussian, data = exp2)
glm2 <- lme4::glm(nplants ~ trat, family = gaussian, data = exp2)
glm2 <- stats::glm(nplants ~ trat, family = gaussian, data = exp2)
glm2 <- stats::glm(nplants ~ trat, family = "gaussian", data = exp2)
#glm2 <- glm(nplants ~ trat, family = gaussian, data = exp2)
summary(glm2)
#glm2 <- glm(nplants ~ trat, family = gaussian, data = exp2)
#summary(glm2)
AIC(glm2)
#glm2 <- glm(nplants ~ trat, family = gaussian, data = exp2)
#summary(glm2)
#AIC(glm2)
glm2b <- glm(nplants ~ trat, family = "poisson", data  = exp2)
summary(glm2b)
glm2b <- glm(nplants ~ trat, family = poisson(link = "log"),
data = exp2)
summary(glm2b)
AIC(glm2b)
wm <- WhiteMoldSoybean
wm |>
ggplot(aes(inc, yld))+
geom_point()+
facet_wrap(~ study)+
theme_minimal()
mofo1 <- lm(yld ~ inc,
data = wm)
#intercepto pordutividade quando a incidencia é zero, inc é o slope com 10% de incidencia esta perdendo 90kg.
summary(mofo1)
wm |>
ggplot(aes(inc, yld, group = factor(study)))+
geom_point()+
#facet_wrap(~ study)+
theme_minimal()+
geom_smooth(method = "lm", se = F)
mofo1 <- lm(yld ~ inc,
data = wm)
summary(mofo1)
library(broom)
fit_all <- wm |>
group_by(study) |>
do(tidy(lm(.$yld ~ .$inc), conf.int = TRUE))
fit_all
fit_all |>
filter(term == "(intercept)") |>
ggplot(aes(x = estimate))+
geom_histogram(bins = 8, color = "white", fill = "gray50")+
theme_r4pde()+
labs(x = "slope", y = "frequency")
library(patchwork)
p3 | p4
library(patchwork)
pyra2 <- pyra |>
group_by(code, dose) |>
summarise(mean_germination = mean(germination))|>
ggplot(aes(dose, mean_germination))+
geom_point()+
facet_wrap(~code)
pyra <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=465348652")
pyra2 <- pyra |>
group_by(code, dose) |>
summarise(mean_germination = mean(germination))|>
ggplot(aes(dose, mean_germination))+
geom_point()+
facet_wrap(~code)
isolado165 <- pyra2 |> filter(code == "165")
isolado165 <- pyra2 |> dplyr::filter(code == "165")
pyra2 <- pyra |>
group_by(code, dose) |>
summarise(mean_germination = mean(germination))
pyra2 |>
ggplot(aes(dose, mean_germination))+
geom_point()+
facet_wrap(~code)
isolado165 <- pyra2 |> dplyr::filer(code == "165")
isolado165 <- pyra2 |> filer(code == "165")
isolado165 <- pyra2 |> filter(code == "165")
drc1 <- drm(mean_germination ~ dose, data = isolado165,
fct = LL.3())
AIC(drc1)
plot(drc1)
# comentario
x <- 10
y <- x * 10
z <- x * y
A <- c(1:10)
b <- c(11:20)
df <- data.frame(A,b)
library(agricolae)
dates<-c(14,21,28)
# days
# example 1: evaluation - vector
evaluation<-c(40,80,90)
audpc(evaluation,dates)
library(epifitter)
plot(pressure)
str(pressure)
df <- cars
cars
df$dist <- log(df$dist)
plot(df$dist)
df$dist
library(tidyverse)
df |>
# comentario
x <- 10
y <- x * 10
z <- x * y
A <- c(1:10)
b <- c(11:20)
df <- data.frame(A,b)
library(agricolae)
dates<-c(14,21,28)
# days
# example 1: evaluation - vector
evaluation<-c(40,80,90)
audpc(evaluation,dates)
library(epifitter)
plot(pressure)
str(pressure)
df <- cars
cars
df$dist <- log(df$dist)
plot(df$dist)
df$dist
library(tidyverse)
milho |>
ggplot(aes(method,index))+
geom_jitter(which = 0.1, alpha = 0.2)+
facet_wrap(~ hybrid)+
stat_summary(fun.data = "mean_cl_boot", size = 0.5, color = "blue")
library(gsheet)
library(tidyverse)
library(lme4)
library(performance)
library(DHARMa)
library(emmeans)
library(multcomp)
library(r4pde)
library(drc)
milho <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1345524759")
milho |>
ggplot(aes(method,index))+
geom_jitter(which = 0.1, alpha = 0.2)+
facet_wrap(~ hybrid)+
stat_summary(fun.data = "mean_cl_boot", size = 0.5, color = "blue")
milho <- milho |>
mutate(block = as.factor(block))
mix2 <- lmer(sqrt(index) ~ hybrid*method + block + (1|block/hybrid), data = milho)
anova (mix2)
check_normality(mix2)
check_heteroscedasticity(mix2)
