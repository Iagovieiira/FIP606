{
  "hash": "dc35707cbfc3d9e9f33c569ff682706f",
  "result": {
    "markdown": "---\ntitle: \"Transformações, ANOVA e teste de média\"\nformat: html\neditor: visual\nmessage: false\nwarning: false\n---\n\n\nDurante a aula 8, foram trabalhados dados para apresender a fazer transformações, ANOVA e teste de médias.\n\n## Pacotes carregados\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(gsheet)\nlibrary(patchwork)\nlibrary(r4pde)\nlibrary(emmeans)\nlibrary(performance)\nlibrary(multcomp)\nlibrary(agricolae)\nlibrary(epifitter)\n```\n:::\n\n\n## **Importando dados**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsoja <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=866852711\")\n```\n:::\n\n\nTransformar para fator = preciso tranformar fator, pois esta como número.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsoja <- soja |> \n  mutate(TRAT = as.factor(TRAT),\n         BLOCO = as.factor(BLOCO))\n\nis.vector(soja)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n\n```{.r .cell-code}\nis.factor(soja$TRAT)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n:::\n\n\n## **visualização dos dados**\n\nPara visualização dos dados das variáveis dependentes (DFC, FER e PROD), serão construídos gráficos de pontos (`ggplot`: `geom_jitter`) acrescido do intervalo de confiança. Para a apresentação do intervalo de confiança, será utilizada a função `stat_summary (fun.data)`, com o argumento `\"mean_cl_boot\"`.\n\nPara visualizar os dados, para variavel DFC.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndfc <- soja |> \n  ggplot(aes(TRAT, DFC)) +\n  geom_jitter(which = 0.05)\ndfc\n```\n\n::: {.cell-output-display}\n![](Aula8_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nPara variavel FER:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfer <- soja |> \n  ggplot(aes(TRAT, FER)) +\n  geom_jitter(which = 0.05)\ndfc\n```\n\n::: {.cell-output-display}\n![](Aula8_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nPara variavel prod:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprod <- soja |> \n  ggplot(aes(TRAT, PROD)) +\n  geom_jitter(which = 0.05)\ndfc\n```\n\n::: {.cell-output-display}\n![](Aula8_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nPara juntar os 3 graficos:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(dfc+fer+prod)\n```\n\n::: {.cell-output-display}\n![](Aula8_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndfc <- soja |> \n  ggplot(aes(TRAT, DFC)) +\n  geom_jitter(width = 0.05, color = \"gray70\") +\n  stat_summary(fun.data = \"mean_cl_boot\", color = \"black\")\n\ndfc\n```\n\n::: {.cell-output-display}\n![](Aula8_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfer <- soja |> \n  ggplot(aes(TRAT, FER)) +\n  geom_jitter(width = 0.05, color = \"gray70\") +\n  stat_summary(fun.data = \"mean_cl_boot\", color = \"black\")\n\ndfc\n```\n\n::: {.cell-output-display}\n![](Aula8_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprod <- soja |> \n  ggplot(aes(TRAT, PROD)) +\n  geom_jitter(width = 0.05, color = \"gray70\") +\n  stat_summary(fun.data = \"mean_cl_boot\", color = \"black\")\n\ndfc\n```\n\n::: {.cell-output-display}\n![](Aula8_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n(dfc+fer+prod)\n```\n\n::: {.cell-output-display}\n![](Aula8_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n### **ANOVA DFC**\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov_dfc <- lm(DFC ~ TRAT + BLOCO,\n              data = soja)\nanova(aov_dfc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: DFC\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nTRAT       7 149.299 21.3284 51.5490 8.218e-12 ***\nBLOCO      3   0.461  0.1537  0.3716    0.7743    \nResiduals 21   8.689  0.4138                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n#Pvalor indicando com *** e o valor baixo, indiccando que o efeito do tratamento é extremamente significativo. Para blocos, não foi significativo. Pode seguir as análises por que pelo menos uma das médias difere uma da outra, agora temos que saber se podemos confiar na anova e testar as suas premissas de normalidade e homosdasticidade.\n```\n:::\n\n\n#### **Verificação das premissas**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_heteroscedasticity(aov_dfc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.532).\n```\n:::\n\n```{.r .cell-code}\ncheck_normality(aov_dfc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.978).\n```\n:::\n:::\n\n\n### **Comparação de médias**\n\nPara comparação de médias o modelo gerado acima será aplicado à função `emmeans` para criação de um novo objeto. Essa função estima uma média com base no modelo, logo algumas vezes pode não ser igual a média aritmética.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedias_dfc <- emmeans(aov_dfc, ~ TRAT)\nmedias_dfc\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n TRAT emmean    SE df lower.CL upper.CL\n 1     10.88 0.322 21    10.21    11.54\n 2      6.42 0.322 21     5.76     7.09\n 3      6.05 0.322 21     5.38     6.72\n 4      4.75 0.322 21     4.08     5.42\n 5      4.20 0.322 21     3.53     4.87\n 6      4.00 0.322 21     3.33     4.67\n 7      4.08 0.322 21     3.41     4.74\n 8      4.58 0.322 21     3.91     5.24\n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \n```\n:::\n:::\n\n\nNa função `pwpm`, há três informações úteis. Na diagonal, é apresentado o valor médio estimado para cada tratamento. Acima da diagonal, são plotados os valores de probabilidade, relacionados ao teste de Tukey, referentes às comparações múltiplas entre tratamentos. Abaixo da diagonal, há a diferença de valores médios entre os tratamentos.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npwpm(medias_dfc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        1       2       3       4       5       6       7       8\n1 [10.87]  <.0001  <.0001  <.0001  <.0001  <.0001  <.0001  <.0001\n2   4.450 [ 6.42]  0.9896  0.0249  0.0017  0.0006  0.0009  0.0107\n3   4.825   0.375 [ 6.05]  0.1329  0.0107  0.0040  0.0058  0.0628\n4   6.125   1.675   1.300 [ 4.75]  0.9202  0.7173  0.8072  0.9999\n5   6.675   2.225   1.850   0.550 [ 4.20]  0.9998  1.0000  0.9896\n6   6.875   2.425   2.050   0.750   0.200 [ 4.00]  1.0000  0.9020\n7   6.800   2.350   1.975   0.675   0.125  -0.075 [ 4.07]  0.9499\n8   6.300   1.850   1.475   0.175  -0.375  -0.575  -0.500 [ 4.57]\n\nRow and column labels: TRAT\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncld(medias_dfc, Letters = LETTERS)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n TRAT emmean    SE df lower.CL upper.CL .group\n 6      4.00 0.322 21     3.33     4.67  A    \n 7      4.08 0.322 21     3.41     4.74  A    \n 5      4.20 0.322 21     3.53     4.87  A    \n 8      4.58 0.322 21     3.91     5.24  AB   \n 4      4.75 0.322 21     4.08     5.42  AB   \n 3      6.05 0.322 21     5.38     6.72   BC  \n 2      6.42 0.322 21     5.76     7.09    C  \n 1     10.88 0.322 21    10.21    11.54     D \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 8 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\n### ANOVA fer\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov_fer <- lm(FER ~ TRAT + BLOCO,\n              data = soja)\nanova(aov_fer)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: FER\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nTRAT       7 978.87 139.838 55.1717 4.218e-12 ***\nBLOCO      3   3.84   1.279  0.5045    0.6834    \nResiduals 21  53.23   2.535                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n#### **Verificação das premissas**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_heteroscedasticity(aov_fer)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p < .001).\n```\n:::\n\n```{.r .cell-code}\ncheck_normality(aov_fer)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Non-normality of residuals detected (p = 0.008).\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Tranformação por logarítimo\n\nsoja <- soja |> \n  mutate(FER2 = log(FER))\n\naov_fer2 <- lm (FER2 ~ TRAT + BLOCO, data = soja)\n\nanova(aov_fer2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: FER2\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nTRAT       7 11.5210 1.64585 42.9665 4.838e-11 ***\nBLOCO      3  0.2064 0.06880  1.7961    0.1788    \nResiduals 21  0.8044 0.03831                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\ncheck_normality(aov_fer2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.255).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(aov_fer2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p = 0.035).\n```\n:::\n\n```{.r .cell-code}\n#A transformação foi suficiente para normalizar os valores do resíduo, no entanto, ainda há heterocedasticidade.\n```\n:::\n\n\n### **Transformação - Box-Cox**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nb <- boxcox(lm(soja$FER ~1))\n```\n\n::: {.cell-output-display}\n![](Aula8_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlambda <- b$x[which.max(b$y)] \nlambda\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -1.555556\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsoja$FER <- (soja$FER^lambda -1)/lambda\nsoja$FER\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] 0.6350214 0.6372165 0.6385564 0.6356880 0.6078962 0.5684565 0.6175462\n [8] 0.5902763 0.6032606 0.5512801 0.4882973 0.5684565 0.5684565 0.5264644\n[15] 0.4882973 0.5264644 0.5512801 0.5512801 0.5264644 0.5264644 0.5512801\n[22] 0.4882973 0.5264644 0.5264644 0.5512801 0.5512801 0.5264644 0.5512801\n[29] 0.5684565 0.5512801 0.5264644 0.5512801\n```\n:::\n:::\n\n\n#### **Novo modelo - Após transformação**\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov_fer2 <- lm(FER ~ TRAT + BLOCO,\n              data = soja)\nanova(aov_fer2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: FER\n          Df   Sum Sq   Mean Sq F value    Pr(>F)    \nTRAT       7 0.041641 0.0059488 12.9020 2.436e-06 ***\nBLOCO      3 0.005895 0.0019649  4.2616   0.01687 *  \nResiduals 21 0.009683 0.0004611                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n#Para os dados transformados por Box-Cox, o fator fixo TRAT continua possuindo efeito significativo, logo há algum tratamento que difere dos demais. Para o fator BLOCO, não houve efeito já que não há diferença significativa entre eles.\n```\n:::\n\n\n#### **Verificação das premissas**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_heteroscedasticity(aov_fer2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.872).\n```\n:::\n\n```{.r .cell-code}\ncheck_normality(aov_fer2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.787).\n```\n:::\n\n```{.r .cell-code}\n#Os testes demonstram que a transformação de Box-Cox foi suficiente para conferir normalidade aos resíduos e homogeneidade de variância entre os grupos.\n```\n:::\n\n\n#### **Comparação de médias**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedias_fer2 <- emmeans(aov_fer2, ~ TRAT)\nmedias_fer2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n TRAT emmean     SE df lower.CL upper.CL\n 1     0.637 0.0107 21    0.614    0.659\n 2     0.596 0.0107 21    0.574    0.618\n 3     0.553 0.0107 21    0.530    0.575\n 4     0.527 0.0107 21    0.505    0.550\n 5     0.539 0.0107 21    0.517    0.561\n 6     0.523 0.0107 21    0.501    0.545\n 7     0.545 0.0107 21    0.523    0.567\n 8     0.549 0.0107 21    0.527    0.572\n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncld(medias_fer2, Letters = LETTERS)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n TRAT emmean     SE df lower.CL upper.CL .group\n 6     0.523 0.0107 21    0.501    0.545  A    \n 4     0.527 0.0107 21    0.505    0.550  A    \n 5     0.539 0.0107 21    0.517    0.561  A    \n 7     0.545 0.0107 21    0.523    0.567  A    \n 8     0.549 0.0107 21    0.527    0.572  AB   \n 3     0.553 0.0107 21    0.530    0.575  AB   \n 2     0.596 0.0107 21    0.574    0.618   BC  \n 1     0.637 0.0107 21    0.614    0.659    C  \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 8 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\n#### ANOVA PROD\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov_prod <- lm(PROD ~ TRAT + BLOCO,\n              data = soja)\nanova(aov_prod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: PROD\n          Df  Sum Sq Mean Sq F value  Pr(>F)  \nTRAT       7 2993906  427701  2.6367 0.04021 *\nBLOCO      3  105665   35222  0.2171 0.88340  \nResiduals 21 3406431  162211                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n#Para o fator fixo TRAT, há efeito significativo, logo há algum tratamento que difere dos demais. Para o fator BLOCO, não houve efeito já que não há diferença significativa entre eles.\n```\n:::\n\n\n#### **Verificação das premissas**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_heteroscedasticity(aov_prod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.215).\n```\n:::\n\n```{.r .cell-code}\n#homegenidade de variancia e heteroscedasticidade é a mesma coisa  \ncheck_normality(aov_prod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.542).\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmedias_prod <- emmeans(aov_prod, ~ TRAT)\nmedias_prod\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n TRAT emmean  SE df lower.CL upper.CL\n 1      4219 201 21     3800     4638\n 2      4935 201 21     4516     5354\n 3      5110 201 21     4691     5529\n 4      5140 201 21     4721     5559\n 5      5122 201 21     4703     5541\n 6      5256 201 21     4837     5675\n 7      5128 201 21     4709     5546\n 8      5078 201 21     4659     5497\n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \n```\n:::\n\n```{.r .cell-code}\n#Os testes mostram que os resíduos são normalmente distribuídos e que há homogeneidade de variâncias entre os grupos. Assim, é possível continuar a comparação de médias.\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npwpm(medias_prod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        1       2       3       4       5       6       7      8\n1  [4219]  0.2430  0.0792  0.0640  0.0728  0.0272  0.0700 0.0985\n2  -715.8  [4935]  0.9983  0.9953  0.9974  0.9430  0.9968 0.9995\n3  -890.8  -175.0  [5110]  1.0000  1.0000  0.9994  1.0000 1.0000\n4  -921.0  -205.3   -30.3  [5140]  1.0000  0.9999  1.0000 1.0000\n5  -902.8  -187.0   -12.0    18.3  [5122]  0.9997  1.0000 1.0000\n6 -1037.0  -321.3  -146.3  -116.0  -134.3  [5256]  0.9998 0.9981\n7  -908.3  -192.5   -17.5    12.8    -5.5   128.8  [5127] 1.0000\n8  -859.0  -143.3    31.7    62.0    43.7   178.0    49.2 [5078]\n\nRow and column labels: TRAT\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncld(medias_prod, Letters = LETTERS)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n TRAT emmean  SE df lower.CL upper.CL .group\n 1      4219 201 21     3800     4638  A    \n 2      4935 201 21     4516     5354  AB   \n 8      5078 201 21     4659     5497  AB   \n 3      5110 201 21     4691     5529  AB   \n 5      5122 201 21     4703     5541  AB   \n 7      5128 201 21     4709     5546  AB   \n 4      5140 201 21     4721     5559  AB   \n 6      5256 201 21     4837     5675   B   \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 8 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_prod <- data.frame(medias_prod)\ndf_prod |> \n  \n  ggplot(aes(TRAT, emmean))+\n  geom_point()+\n  ylim(3000,6500)+\n  geom_errorbar(aes(min = lower.CL,\n                    max = upper.CL),\n                width = 0.1)+\nannotate (geom = \"text\", x = 1.2, y = 4200,\n         label = \"A\")\n```\n\n::: {.cell-output-display}\n![](Aula8_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#Gráfico com médias e intervalo de confiança, uma maneira visual de apresentar os resultados.\n```\n:::\n\n\n## CONJUNTO DE DADOS COUVE\n\n## **Importando dados**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncouve <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1807247585\")\n```\n:::\n\n\nPara construção de uma curva de progresso da doença usaremos como exemplo um conjunto de dados que descreve diferentes métodos de irrigação (variável independente, um fator, 2 níveis) e seu efeito sobre a severidade (variável dependente) ao longo dos dias.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncov <- couve |> \n  ggplot(aes(day, severity)) +\n   geom_point(which = 0.05)+\n  facet_wrap(~~ Irrigation)\ncov\n```\n\n::: {.cell-output-display}\n![](Aula8_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n:::\n\n\nFoi criada uma figura com dois gráficos. Um para cada nível do fator \"Irrigation\":\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncouve |> \n  group_by(day, Irrigation) |> \n  summarise(mean_sev = mean(severity)) |> \n  ggplot(aes(day, mean_sev)) +\n   geom_point(which = 0.05)+ \n  geom_line()+\n  facet_wrap(~~ Irrigation)\n```\n\n::: {.cell-output-display}\n![](Aula8_files/figure-html/unnamed-chunk-35-1.png){width=672}\n:::\n:::\n\n\n### **Cálculo da área abaixo da curva de progresso da doença**\n\nPara o cálculo da área abaixo da curva de progresso da doença (AACPD, ou \"*area under the disease progress curve\",* AUDPC), será criado um novo dataframe. Para isso, será feito o agrupamento (`group_by`) das variáveis em função do tratamento (\"Irrigation\") e das repetições (\"rep\"). Em seguida, será utilizada a função `summarise` para o cálculo da AACPD (função `AUDPC`, pacote **`epifitter`**).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#AACPD\n\ncouve2 <- couve |> \n  group_by(Irrigation, rep) |> \n  summarise(aacpd = AUDPC(day, severity))\n```\n:::\n\n\n### **ANOVA**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm_couve <- lm(aacpd ~ Irrigation + factor(rep), data = couve2)\nanova(m_couve)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: aacpd\n            Df  Sum Sq  Mean Sq F value  Pr(>F)  \nIrrigation   1 0.23602 0.236017  10.605 0.08275 .\nfactor(rep)  2 0.61291 0.306454  13.771 0.06770 .\nResiduals    2 0.04451 0.022254                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n#A ANOVA mostra que não há diferença entre as áreas.\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#coeficiente de variação\n#muito baixo \n\ncv.model(m_couve)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.097572\n```\n:::\n:::\n",
    "supporting": [
      "Aula8_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}