{
  "hash": "dcbccd76ba28536407d67a9f982138e4",
  "result": {
    "markdown": "---\ntitle: \"Experimento fatorial e ajuste de modelos - Análise de correlação\"\nformat: html\neditor: visual\nmessage: false\nwarning: false\n---\n\n\nDurante a aula 9, vão ser estudados dados que levam a entender melhor os Experimento fatorial e ajuste de modelos\n\n## Pacotes carregados\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gsheet)\nlibrary(tidyverse)\nlibrary(lme4)\nlibrary(performance)\nlibrary(DHARMa)\nlibrary(emmeans)\nlibrary(multcomp)\nlibrary(r4pde)\nlibrary(drc)\nlibrary(stats)\n```\n:::\n\n\n## **Importando dados**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmilho <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1345524759\")\n```\n:::\n\n\n## **Análise de um experimento em parcelas subdivididas**\n\nExperimentos em parcelas subdivididas são utilizados quando o nível de um fator primário (ou tratamento) é aplicado a uma parcela relativamente grande e todos os níveis de um segundo fator secundário são aplicados às subparcelas desta parcela maior. Os tratamentos primários são distribuídos às parcelas de acordo com um delineamento especificado, já os tratamentos secundários são distribuídos às subparcelas de forma aleatória.\n\n## **visualização dos dados**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmilho |> \n  ggplot(aes(method,index))+\n  geom_jitter(which = 0.1, alpha = 0.2)+\n  facet_wrap(~ hybrid)+\n  stat_summary(fun.data = \"mean_cl_boot\", size = 0.5, color = \"blue\")\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n##Dependendo do híbrido parece que há efeito do método\n```\n:::\n\n\n## **Modelo para parcela subdividida**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmilho <- milho |> \n  mutate(block = as.factor(block))\n\nmix2 <- lmer(index ~ hybrid*method + block + (1|block/hybrid),\n            data = milho)\n\n\n#No fator aleatório, colocamos o hibrido dentro do bloco. ( 1 | block/hybrid); Comparamos os híbridos nas linhas e os métodos nas colunas.\n```\n:::\n\n\nANOVA MIX2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova (mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n              npar  Sum Sq Mean Sq F value\nhybrid           5 262.548  52.510  3.1194\nmethod           1  79.053  79.053  4.6963\nblock            3   3.630   1.210  0.0719\nhybrid:method    5 266.064  53.213  3.1612\n```\n:::\n:::\n\n\n#### **Verificação das premissas**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_normality(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.635).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p = 0.009).\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(simulateResiduals(mix2))\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(residuals(mix2))\nqqline(residuals(mix2))\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(residuals(mix2))\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-7-3.png){width=672}\n:::\n:::\n\n\nConclui-se que os dados seguem distribuição normal. Porém, não há homogeneidade de variância entre os grupos. Logo será preciso uma alternativa para prosseguir a análise, por exemplo a transformação dos dados com raiz quadrada.\n\nDepois de carregar o Emmeans:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedias_milho <- emmeans(mix2,\n                        ~ hybrid | method,\n                        type = \"response\")\nmedias_milho\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nmethod = pin:\n hybrid   emmean   SE   df lower.CL upper.CL\n 30F53 HX   25.3 8.13 1022     9.32     41.2\n 30F53 YH   24.6 8.13 1022     8.64     40.6\n 30K64      20.6 8.13 1022     4.59     36.5\n 30S31H     38.1 8.13 1022    22.14     54.1\n 30S31YH    32.5 8.13 1022    16.54     48.5\n BG7049H    19.4 8.13 1022     3.49     35.4\n\nmethod = silk:\n hybrid   emmean   SE   df lower.CL upper.CL\n 30F53 HX   25.0 8.13 1022     9.04     41.0\n 30F53 YH   26.2 8.13 1022    10.29     42.2\n 30K64      21.5 8.13 1022     5.54     37.5\n 30S31H     26.5 8.13 1022    10.54     42.5\n 30S31YH    26.6 8.13 1022    10.69     42.6\n BG7049H    19.2 8.13 1022     3.22     35.1\n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \n```\n:::\n\n```{.r .cell-code}\nmedias_milho2 <- emmeans(mix2,\n                         ~ method | hybrid,\n                         type = \"response\")\nmedias_milho2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nhybrid = 30F53 HX:\n method emmean   SE   df lower.CL upper.CL\n pin      25.3 8.13 1022     9.32     41.2\n silk     25.0 8.13 1022     9.04     41.0\n\nhybrid = 30F53 YH:\n method emmean   SE   df lower.CL upper.CL\n pin      24.6 8.13 1022     8.64     40.6\n silk     26.2 8.13 1022    10.29     42.2\n\nhybrid = 30K64:\n method emmean   SE   df lower.CL upper.CL\n pin      20.6 8.13 1022     4.59     36.5\n silk     21.5 8.13 1022     5.54     37.5\n\nhybrid = 30S31H:\n method emmean   SE   df lower.CL upper.CL\n pin      38.1 8.13 1022    22.14     54.1\n silk     26.5 8.13 1022    10.54     42.5\n\nhybrid = 30S31YH:\n method emmean   SE   df lower.CL upper.CL\n pin      32.5 8.13 1022    16.54     48.5\n silk     26.6 8.13 1022    10.69     42.6\n\nhybrid = BG7049H:\n method emmean   SE   df lower.CL upper.CL\n pin      19.4 8.13 1022     3.49     35.4\n silk     19.2 8.13 1022     3.22     35.1\n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncld(medias_milho2, Letters = LETTERS)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nhybrid = 30F53 HX:\n method emmean   SE   df lower.CL upper.CL .group\n silk     25.0 8.13 1022     9.04     41.0  A    \n pin      25.3 8.13 1022     9.32     41.2  A    \n\nhybrid = 30F53 YH:\n method emmean   SE   df lower.CL upper.CL .group\n pin      24.6 8.13 1022     8.64     40.6  A    \n silk     26.2 8.13 1022    10.29     42.2  A    \n\nhybrid = 30K64:\n method emmean   SE   df lower.CL upper.CL .group\n pin      20.6 8.13 1022     4.59     36.5  A    \n silk     21.5 8.13 1022     5.54     37.5  A    \n\nhybrid = 30S31H:\n method emmean   SE   df lower.CL upper.CL .group\n silk     26.5 8.13 1022    10.54     42.5  A    \n pin      38.1 8.13 1022    22.14     54.1   B   \n\nhybrid = 30S31YH:\n method emmean   SE   df lower.CL upper.CL .group\n silk     26.6 8.13 1022    10.69     42.6  A    \n pin      32.5 8.13 1022    16.54     48.5  A    \n\nhybrid = BG7049H:\n method emmean   SE   df lower.CL upper.CL .group\n silk     19.2 8.13 1022     3.22     35.1  A    \n pin      19.4 8.13 1022     3.49     35.4  A    \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\nA significância da anova ou efeitos da interação; Realiza-se o teste de médias se há efeito; Comparamos a diferença dentro dos métodos, e depois, comparamos a diferença entre os métodos dentro dos híbridos.\n\n## **Produtividade (yield)**\n\nSeguindo os mesmos procedimentos para o índice de doença, será conduzida avaliação da produtividade.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmix3 <- lmer(sqrt(index) ~ hybrid*method + block + (1|block/hybrid), data = milho)\n```\n:::\n\n\n**ANOVA MIX3**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova (mix3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n              npar  Sum Sq Mean Sq F value\nhybrid           5 2.14415 0.42883  3.0632\nmethod           1 0.54438 0.54438  3.8886\nblock            3 0.01004 0.00335  0.0239\nhybrid:method    5 1.87331 0.37466  2.6762\n```\n:::\n:::\n\n\n#### **Verificação das premissas**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_normality(mix3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.440).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mix3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.971).\n```\n:::\n:::\n\n\n# **Regressão linear**\n\nUsada para modelar e analisar a relação entre uma variável dependente (também chamada de variável resposta) e uma ou mais variáveis independentes (também chamadas de variáveis preditoras). O objetivo da regressão linear é ajustar uma linha reta (ou um plano, no caso de múltiplas variáveis) aos dados que minimiza a soma dos quadrados dos resíduos (a diferença entre os valores observados e os valores previstos pelo modelo).\n\n## **Importando dados**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nestande <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=401662555\")\n```\n:::\n\n\n## **visualização dos dados**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n   estande |> \n  ggplot(aes(trat, nplants))+\n  geom_jitter(which = 0.1, alpha = 0.3)+\n  facet_wrap(~ exp)+\n  stat_summary(fun.data = \"mean_cl_boot\", size = 0.5, color = \"black\")+\n     geom_smooth(method = \"lm\", se = F)\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n```{.r .cell-code}\n   #Mostramos biologicamente que há redução do estande de plantas conforme o aumento da inoculação do patógeno. podemos assumir dois modelos: linear simples ou quadrático. Podemos verificar qual modelo se adequa melhor à regressão.\n```\n:::\n\n\nExperimento 1:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexp1 <- estande |> \n  filter(exp == 1)\n\nexp1 |> \n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  geom_smooth(se = F)\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#MODELO LINEAR\n\nlm1 = lm(nplants ~ trat,\n         data = exp1)\n\nsummary (lm1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat, data = exp1)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.500  -6.532   1.758   8.573  27.226 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  52.5000     4.2044  12.487 1.84e-11 ***\ntrat         -0.2419     0.1859  -1.301    0.207    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 15 on 22 degrees of freedom\nMultiple R-squared:  0.07148,\tAdjusted R-squared:  0.02928 \nF-statistic: 1.694 on 1 and 22 DF,  p-value: 0.2066\n```\n:::\n:::\n\n\nExperimento 2:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexp2 <- estande |> \n  filter(exp == 2)\n\nexp2 |> \n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  geom_smooth(se = F, method = \"lm\",\n              formula = y~poly(x,2),\n              color = \"red\")+\n  geom_smooth(method = \"lm\", se = FALSE)\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Modelo de primeira ordem\nlm2 <- lm(nplants~trat,\n          data = exp2)\n\nsummary(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat, data = exp2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.7816  -7.7150   0.5653   8.1929  19.2184 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  60.9857     3.6304  16.798 4.93e-14 ***\ntrat         -0.7007     0.1605  -4.365 0.000247 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.95 on 22 degrees of freedom\nMultiple R-squared:  0.4641,\tAdjusted R-squared:  0.4398 \nF-statistic: 19.05 on 1 and 22 DF,  p-value: 0.0002473\n```\n:::\n\n```{.r .cell-code}\nhist(residuals(lm2))\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Nodelo de segunda ordem\nexp2$trat2 <- exp2$trat^2\n```\n:::\n\n\nExperimento 3:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexp3 <- estande |> \n  filter(exp == 3)\n\nexp3 |> \n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  geom_smooth(se = F) #method = \"lm\")\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlm3 <- lm(nplants~trat + trat2,\n          data = exp2)\n\nsummary(lm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat + trat2, data = exp2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.439  -6.019   1.789   8.016  19.561 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 66.30156    4.42097  14.997 1.08e-12 ***\ntrat        -1.77720    0.58467  -3.040  0.00623 ** \ntrat2        0.02223    0.01166   1.906  0.07036 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.24 on 21 degrees of freedom\nMultiple R-squared:  0.5432,\tAdjusted R-squared:  0.4997 \nF-statistic: 12.49 on 2 and 21 DF,  p-value: 0.0002675\n```\n:::\n\n```{.r .cell-code}\nhist(residuals(lm3))\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\nComparação de modelos diferente usando os mesmos dados\n\n### **Usando GLM**\n\nPodemos atribuir o glm com distribuição normal ou distribuição de poisson (considerando que a distribuição não é normal).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#glm2 <- glm(nplants ~ trat, family = gaussian, data = exp2)\n#summary(glm2)\n\n#AIC(glm2)\n\nglm2b <- glm(nplants ~ trat, family = \"poisson\", data  = exp2)\nsummary(glm2b)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = nplants ~ trat, family = \"poisson\", data = exp2)\n\nCoefficients:\n             Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  4.134189   0.037583 110.003  < 2e-16 ***\ntrat        -0.016270   0.002059  -7.901 2.76e-15 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 139.783  on 23  degrees of freedom\nResidual deviance:  69.578  on 22  degrees of freedom\nAIC: 210.24\n\nNumber of Fisher Scoring iterations: 4\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglm2b <- glm(nplants ~ trat, family = poisson(link = \"log\"),\n             data = exp2)\nsummary(glm2b)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = nplants ~ trat, family = poisson(link = \"log\"), \n    data = exp2)\n\nCoefficients:\n             Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  4.134189   0.037583 110.003  < 2e-16 ***\ntrat        -0.016270   0.002059  -7.901 2.76e-15 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 139.783  on 23  degrees of freedom\nResidual deviance:  69.578  on 22  degrees of freedom\nAIC: 210.24\n\nNumber of Fisher Scoring iterations: 4\n```\n:::\n\n```{.r .cell-code}\nAIC(glm2b)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 210.2353\n```\n:::\n:::\n\n\n## **Análise de múltiplos ensaios**\n\nCom múltiplos ensaios, é possível analisá-los individualmente para observar uma tendência geral no comportamento dos tratamentos. No entanto, existem outras alternativas, como aplicar um modelo de regressão linear global ou extrair a informação global utilizando modelos mistos. Nesse caso, os ensaios são tratados como fator aleatório, ou seja, advêm de uma distribuição (população), e o objetivo é estimar os parâmetros para essa população. Para exemplificar esse caso, um conjunto de dados (`WhiteMoldSoybean`) presente no pacote **`r4pde`** será importado, mas antes o pacote deverá ser carregado. AIC menor é o melhor modelo ajustado.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwm <- WhiteMoldSoybean\n\n\nwm |> \n  ggplot(aes(inc, yld))+\n  geom_point()+\n  facet_wrap(~ study)+\n  theme_minimal()+\n  geom_smooth(method = \"lm\", se = F)\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#Predizer uma resposta em relação à outra. Duas respostas numéricas contínuas, ajustanto o modelo linear ou não. Muitos estudos diferentes, gráfico geral. A saída dos gráficos mostra que com a ação do fungicida e redução da severidade acontece um incremento de produtividade da soja.\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmofo1 <- lm(yld ~ inc,\n            data = wm)\n#intercepto pordutividade quando a incidencia é zero, inc é o slope com 10% de incidencia esta perdendo 90kg. \nsummary(mofo1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = yld ~ inc, data = wm)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1657.85  -594.50   -91.32   531.76  1693.15 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 3299.619     56.451  58.451  < 2e-16 ***\ninc           -9.261      2.108  -4.393 1.45e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 745.8 on 380 degrees of freedom\nMultiple R-squared:  0.04833,\tAdjusted R-squared:  0.04582 \nF-statistic:  19.3 on 1 and 380 DF,  p-value: 1.452e-05\n```\n:::\n\n```{.r .cell-code}\n#O 3299 é a produtividade por ha quando não há controle. O 9,261 indica a redução de produtividade em kg/ha de acordo com o aumento da severidade.\n```\n:::\n\n\n### **Modelo linear por ensaio**\n\nAgrupando todos os estudos em um único gráfico.\n\n#### **Mofo 1**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwm |> \n  ggplot(aes(inc, yld, group = factor(study)))+\n  geom_point()+\n  #facet_wrap(~ study)+\n  theme_minimal()+\n  geom_smooth(method = \"lm\", se = F)\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n\n```{.r .cell-code}\nmofo1 <- lm(yld ~ inc,\n            data = wm)\nsummary(mofo1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = yld ~ inc, data = wm)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1657.85  -594.50   -91.32   531.76  1693.15 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 3299.619     56.451  58.451  < 2e-16 ***\ninc           -9.261      2.108  -4.393 1.45e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 745.8 on 380 degrees of freedom\nMultiple R-squared:  0.04833,\tAdjusted R-squared:  0.04582 \nF-statistic:  19.3 on 1 and 380 DF,  p-value: 1.452e-05\n```\n:::\n\n```{.r .cell-code}\n#Código muito importante para agrupar vários experimentos. Já detalha as médias para cada variável resposta.\n```\n:::\n\n\n#### **Mofo 2**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(broom)\nmofo2 <- wm |> \n  group_by(study) |> \n  do(tidy(lm(.$yld ~ .$inc), conf.int = TRUE))\nmofo2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 70 × 8\n# Groups:   study [35]\n   study term        estimate std.error statistic  p.value conf.low conf.high\n   <dbl> <chr>          <dbl>     <dbl>     <dbl>    <dbl>    <dbl>     <dbl>\n 1     1 (Intercept)  3329.       86.8      38.3  4.60e-13   3138.    3520.  \n 2     1 .$inc         -14.2       2.08     -6.85 2.78e- 5    -18.8     -9.64\n 3     2 (Intercept)  2682.       48.6      55.2  8.55e-15   2575.    2789.  \n 4     2 .$inc          -6.93      1.49     -4.66 6.89e- 4    -10.2     -3.66\n 5     3 (Intercept)  4017.       61.6      65.2  1.37e-15   3882.    4153.  \n 6     3 .$inc         -18.6       1.71    -10.9  3.11e- 7    -22.4    -14.9 \n 7     4 (Intercept)  2814.      151.       18.6  1.15e- 9   2481.    3147.  \n 8     4 .$inc         -43.5      16.8      -2.58 2.56e- 2    -80.5     -6.38\n 9     5 (Intercept)  3317.      234.       14.2  2.07e- 8   2802.    3832.  \n10     5 .$inc         -21.2       5.69     -3.72 3.36e- 3    -33.7     -8.67\n# ℹ 60 more rows\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf<- mofo2 |> \n  filter(term == \".$inc\")\nmean(df$estimate)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -19.52932\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Histograma da produtividade quando incidência é 0\nlibrary(cowplot)\np1 <- mofo2 |> \n  filter(term == \"(Intercept)\") |> \n           ggplot(aes(x = estimate))+\n           geom_histogram(bins = 8, color = \"white\", fill = \"gray\")+\n           theme_r4pde()+\n           labs(x = \"Intercept\", y = \"frequency\")\np2 <- mofo2 |> \n  filter(term == \".$inc\") |> \n           ggplot(aes(x = estimate))+\n           geom_histogram(bins = 8, color = \"white\", fill = \"gray\")+\n           theme_r4pde()+\n           labs(x = \"Slopes\", y = \"frequency\")\nlibrary(patchwork)\np1+p2\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n**Mofo 3**\n\n**Modelo misto**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Modelo misto\nmofo3 <- lmer(yld ~ inc + (inc | study), data = wm,\n              REML = F)\nsummary(mofo3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear mixed model fit by maximum likelihood  ['lmerMod']\nFormula: yld ~ inc + (inc | study)\n   Data: wm\n\n     AIC      BIC   logLik deviance df.resid \n  5319.4   5343.1  -2653.7   5307.4      376 \n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.7078 -0.5991 -0.0295  0.5077  3.2364 \n\nRandom effects:\n Groups   Name        Variance  Std.Dev. Corr \n study    (Intercept) 557573.08 746.708       \n          inc             36.85   6.071  -0.29\n Residual              37228.73 192.947       \nNumber of obs: 382, groups:  study, 35\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept) 3455.432    128.063   26.98\ninc          -17.236      1.451  -11.88\n\nCorrelation of Fixed Effects:\n    (Intr)\ninc -0.300\noptimizer (nloptwrap) convergence code: 0 (OK)\nModel failed to converge with max|grad| = 0.416806 (tol = 0.002, component 1)\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lme4)\nmofo3 <- lmer(yld ~ inc + (inc|study), data = wm, REML = F)\nsummary(mofo3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear mixed model fit by maximum likelihood  ['lmerMod']\nFormula: yld ~ inc + (inc | study)\n   Data: wm\n\n     AIC      BIC   logLik deviance df.resid \n  5319.4   5343.1  -2653.7   5307.4      376 \n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.7078 -0.5991 -0.0295  0.5077  3.2364 \n\nRandom effects:\n Groups   Name        Variance  Std.Dev. Corr \n study    (Intercept) 557573.08 746.708       \n          inc             36.85   6.071  -0.29\n Residual              37228.73 192.947       \nNumber of obs: 382, groups:  study, 35\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept) 3455.432    128.063   26.98\ninc          -17.236      1.451  -11.88\n\nCorrelation of Fixed Effects:\n    (Intr)\ninc -0.300\noptimizer (nloptwrap) convergence code: 0 (OK)\nModel failed to converge with max|grad| = 0.416806 (tol = 0.002, component 1)\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwm <- WhiteMoldSoybean\n\nwm |> \n  ggplot(aes(inc, yld)) +\n  geom_point() +\n  #facet_wrap(~ study) +\n  theme_minimal() +\n  geom_smooth(method = 'lm', se = T)\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmofo1 <-  lm(yld ~ inc, data = wm)\nsummary(mofo1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = yld ~ inc, data = wm)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1657.85  -594.50   -91.32   531.76  1693.15 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 3299.619     56.451  58.451  < 2e-16 ***\ninc           -9.261      2.108  -4.393 1.45e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 745.8 on 380 degrees of freedom\nMultiple R-squared:  0.04833,\tAdjusted R-squared:  0.04582 \nF-statistic:  19.3 on 1 and 380 DF,  p-value: 1.452e-05\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwm <- WhiteMoldSoybean\nwm |> \n  ggplot(aes(inc, yld))+\n  geom_point()+\n  facet_wrap(~ study)+\n  theme_minimal()+\n  geom_smooth(method = \"lm\", se = F)\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#Predizer uma resposta em relação à outra. Duas respostas numéricas contínuas, ajustanto o modelo linear ou não. Muitos estudos diferentes, gráfico geral. A saída dos gráficos mostra que com a ação do fungicida e redução da severidade acontece um incremento de produtividade da soja.\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmofo1 <-  lmer(yld ~ inc + (inc|study), data = wm, REML = F)\n\nsummary(mofo3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear mixed model fit by maximum likelihood  ['lmerMod']\nFormula: yld ~ inc + (inc | study)\n   Data: wm\n\n     AIC      BIC   logLik deviance df.resid \n  5319.4   5343.1  -2653.7   5307.4      376 \n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.7078 -0.5991 -0.0295  0.5077  3.2364 \n\nRandom effects:\n Groups   Name        Variance  Std.Dev. Corr \n study    (Intercept) 557573.08 746.708       \n          inc             36.85   6.071  -0.29\n Residual              37228.73 192.947       \nNumber of obs: 382, groups:  study, 35\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept) 3455.432    128.063   26.98\ninc          -17.236      1.451  -11.88\n\nCorrelation of Fixed Effects:\n    (Intr)\ninc -0.300\noptimizer (nloptwrap) convergence code: 0 (OK)\nModel failed to converge with max|grad| = 0.416806 (tol = 0.002, component 1)\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nconfint(mofo3, method = \"Wald\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                 2.5 %     97.5 %\n.sig01              NA         NA\n.sig02              NA         NA\n.sig03              NA         NA\n.sigma              NA         NA\n(Intercept) 3204.43403 3706.43096\ninc          -20.08046  -14.39219\n```\n:::\n:::\n\n\n**Aula 10 - 29/05**\n\n# **Análise de correlação**\n\n## Pacotes carregados\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#pacotes \nlibrary(tidyverse)\nlibrary(patchwork)\nlibrary(AgroR)\nlibrary(corrplot)\n```\n:::\n\n\n## **Importando dados**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nimgs <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=373270992\")\n```\n:::\n\n\nr2: coeficiente de determinação o quento da variação de y explicada pelo x;\n\nCoenficiente de correlação: a força de associação entre x e y;\n\nAnálise preeliminar dos dados.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nimgs1 <- imgs|> \n  ggplot(aes(Assess, LeafDoctor))+\ngeom_point()+ geom_smooth(method = \"lm\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nimgs2 <- imgs|> \n  ggplot(aes(Assess, ImageJ))+\ngeom_point()+geom_smooth(method = \"lm\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nimgs3 <- imgs |> \n  ggplot(aes(LeafDoctor, ImageJ))+\ngeom_point()+geom_smooth(method = \"lm\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nimgs1 + imgs2 + imgs3\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-41-1.png){width=672}\n:::\n:::\n\n\n## **Utilizando o AgroR**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#matriz de correlação \nimgs2 <- imgs |> \n  dplyr::select(3:5)\n\n  corgraph(imgs2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        Var1       Var2       cor            p\n2 LeafDoctor     Assess 0.9666367 5.972544e-42\n3     ImageJ     Assess 0.9776918 8.143613e-48\n6     ImageJ LeafDoctor 0.9797478 3.144091e-49\n```\n:::\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-42-1.png){width=672}\n:::\n:::\n\n\nMatriz de correlação Cor entrega o coeficiente de correlação de pearson. O cor test da uma estatística mais completa. O valor observado 0,98 é bem próximo de um, então indica uma correlação forte. Quanto maior a correlação menor o p-valor, se os dados forem mais dispersos o p-valor vai ser maior e não vai ser significativo. O corgraph é um pacote que indica a correlação entre as respostas da análise. Os valores dentro da matriz irão indicar o coeficiente de correlação entre as varíaveis observadas.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor.test(imgs$Assess, imgs$LeafDoctor)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's product-moment correlation\n\ndata:  imgs$Assess and imgs$LeafDoctor\nt = 31.119, df = 68, p-value < 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9466882 0.9792005\nsample estimates:\n      cor \n0.9666367 \n```\n:::\n\n```{.r .cell-code}\n  cor(imgs$Assess, imgs$LeafDoctor)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9666367\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncor_imgs2 <- cor(imgs2)\ncorrplot(cor_imgs2, method = \"number\", type = \"upper\")\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-44-1.png){width=672}\n:::\n:::\n\n\n## **Importando dados**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncampo <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=866852711\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncampo2 <- campo |> \n  dplyr::select(DFC, FER, PROD)\n\ncorgraph(campo2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Var1 Var2        cor            p\n2  FER  DFC  0.9316978 9.864101e-15\n3 PROD  DFC -0.6928161 1.110652e-05\n6 PROD  FER -0.6258321 1.277444e-04\n```\n:::\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-46-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncampo |> \n  ggplot(aes(DFC, PROD))+\n  geom_jitter()\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-47-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#O modelo quadratico é um experimento melhor do que o de primeira ordem, explica melhor o que vemos no gráfico anterior e a variação dos desvios. Pode ser utilizado essa variação, predizer o numero de plantas afetadas. y = (66,3 - 1,77trat) + (0,02trat^2) : equação do modelo\n```\n:::\n\n\n## **Importando dados**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nestande <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=401662555\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nestande |>\n  ggplot(aes(trat, nplants, color = factor (exp))) +\n  geom_boxplot() +\n  facet_wrap(~ exp) +\n  theme_bw() +\n  stat_summary(fun.data = \"mean_cl_boot\", size = 0.5,\n               color = \"black\")\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-49-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nestande |>\n  ggplot(aes(trat, nplants, color = factor (exp))) +\n  geom_jitter(width = 0.1, alpha = 0.2) +\n  facet_wrap(~exp) +\n  theme_bw() +\n  stat_summary(fun.data = \"mean_cl_boot\", size = 0.5,\n               color = \"black\") +\n  geom_smooth(method = \"lm\", se = F)\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-50-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nexp2 <- estande |>\n  filter (exp == 2)\n\nexp2 |> \n  ggplot(aes(trat, nplants)) +\n  geom_point() +\n  ylim(0,100) +\n  geom_smooth(method = \"lm\", se = F, formula = y ~poly(x,2), color = \"black\") +\n  geom_smooth(method = \"lm\",\n              se = FALSE)\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-51-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#MODELO LINEAR\n\nexp2$trat2 <- exp2$trat^2\n\n#primeira ordem\nlm2 <- lm(nplants ~ trat, \n          data = exp2)\nsummary(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat, data = exp2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.7816  -7.7150   0.5653   8.1929  19.2184 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  60.9857     3.6304  16.798 4.93e-14 ***\ntrat         -0.7007     0.1605  -4.365 0.000247 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.95 on 22 degrees of freedom\nMultiple R-squared:  0.4641,\tAdjusted R-squared:  0.4398 \nF-statistic: 19.05 on 1 and 22 DF,  p-value: 0.0002473\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(residuals(lm2))\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-53-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#segunda ordem\n\nlm3 <- lm(nplants ~ trat + trat2, \n          data = exp2)\nsummary(lm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat + trat2, data = exp2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.439  -6.019   1.789   8.016  19.561 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 66.30156    4.42097  14.997 1.08e-12 ***\ntrat        -1.77720    0.58467  -3.040  0.00623 ** \ntrat2        0.02223    0.01166   1.906  0.07036 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.24 on 21 degrees of freedom\nMultiple R-squared:  0.5432,\tAdjusted R-squared:  0.4997 \nF-statistic: 12.49 on 2 and 21 DF,  p-value: 0.0002675\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(residuals(lm3))\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-55-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nAIC(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 194.9597\n```\n:::\n\n```{.r .cell-code}\nAIC(lm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 193.1284\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(AgroR)\nwith(exp2, polynomial(trat, nplants, grau = 3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n----------------------------------------------------\nRegression Models\n----------------------------------------------------\n                Estimate  Std. Error   t value     Pr(>|t|)\n(Intercept) 70.265143802 5.300440019 13.256474 2.295186e-11\ntrat        -3.609380523 1.514625525 -2.383018 2.720299e-02\nI(trat^2)    0.140522077 0.091192577  1.540938 1.390058e-01\nI(trat^3)   -0.001712445 0.001309648 -1.307561 2.058546e-01\n\n----------------------------------------------------\nDeviations from regression\n----------------------------------------------------\n          Df       SSq       MSQ          F      p-value\nLinear     1 3196.2031 3196.2031 21.8232929 0.0001899378\nQuadratic  1  544.5029  544.5029  3.7178008 0.0697619482\nCubic      1  247.7520  247.7520  1.6916208 0.2097934169\nDeviation  2  261.9170  130.9585  0.8941691 0.4263523326\nResidual  18 2636.2500  146.4583                        \n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\n```\n:::\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-57-1.png){width=672}\n:::\n:::\n\n\n## **Importando dados**\n\n\n::: {.cell}\n\n```{.r .cell-code}\npyra <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=465348652\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npyra2 <- pyra |> \n  group_by(code, dose) |> \n  summarise(mean_germination = mean(germination))\n\npyra2 |> \n  ggplot(aes(dose, mean_germination))+\n  geom_point()+\n  facet_wrap(~code)\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-59-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npyra2 <- pyra |>\n  group_by(code, dose) |>\n  summarise(mean_germination = mean(germination)) \n \nlibrary(drc)\n\nisolado186 <- pyra2 |>\n  filter(code == \"186\")\n\ndrc1 <- drm(mean_germination ~ dose, data = isolado186,\n            fct = LL.3())\nAIC(drc1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 21.11219\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(drc1)\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-61-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nED(drc1, 50, interval = \"delta\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nEstimated effective doses\n\n       Estimate Std. Error    Lower    Upper\ne:1:50 0.579757   0.013332 0.537328 0.622187\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(drc1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nModel fitted: Log-logistic (ED50 as parameter) with lower limit at 0 (3 parms)\n\nParameter estimates:\n\n               Estimate Std. Error t-value   p-value    \nb:(Intercept)  4.997636   0.542650  9.2097  0.002708 ** \nd:(Intercept) 48.750109   0.721642 67.5545 7.148e-06 ***\ne:(Intercept)  0.579757   0.013332 43.4853 2.677e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error:\n\n 1.020525 (3 degrees of freedom)\n```\n:::\n:::\n\n\n### **Usando o pacote ec50estimator**\n\nFaz tudo isso que foi feito anteriormente para todos os códigos.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ec50estimator)\n\n\ndf_ec50 <- estimate_EC50(mean_germination ~ dose, \n                         data = pyra2, \n                         isolate_col = \"code\",\n                         interval = \"delta\", \n                         fct = drc::LL.3())\n```\n:::\n\n\nGráfico com as doses de EC50 e intervalo de confiança:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_ec50 |> \n  ggplot(aes(reorder(ID, Estimate), Estimate))+\n  geom_point()+\n  geom_errorbar(aes(ymin = Lower,\n                    ymax = Upper),\n                width = 0.1)+\n  ylim (0, 1.2)+\n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](Aula9e10_files/figure-html/unnamed-chunk-65-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Aula9e10_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}