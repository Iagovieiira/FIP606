{
  "hash": "bb90775a4d5e9e2b5c7e22f474a66ed5",
  "result": {
    "markdown": "---\ntitle: \"Aula 6\"\nformat: html\neditor: visual\nmessage: false\nwarnig: false\n---\n\n\n#Inferencial\n\n#Dois grupos diferentes (independentes)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#pacotes carregados \nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tidyverse' was built under R version 4.3.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.3     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(gsheet)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'gsheet' was built under R version 4.3.3\n```\n:::\n\n```{.r .cell-code}\nlibrary(multcomp)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'multcomp' was built under R version 4.3.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: mvtnorm\nCarregando pacotes exigidos: survival\nCarregando pacotes exigidos: TH.data\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'TH.data' was built under R version 4.3.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: MASS\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'MASS' was built under R version 4.3.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'MASS'\n\nThe following object is masked from 'package:dplyr':\n\n    select\n\n\nAttaching package: 'TH.data'\n\nThe following object is masked from 'package:MASS':\n\n    geyser\n```\n:::\n\n```{.r .cell-code}\nlibrary(multcompView)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'multcompView' was built under R version 4.3.3\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Importar pacotes \n\nmg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=983033137\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#vizualização\nmg |> \n  ggplot(aes(trat, comp))+\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](Aula6e7_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#demonstra o efeito da suplementação de magnesio que induz a resistencia, visando testar uma hipotese cientifica é que com a suplementação induz a resistencia \n#a hipotese nula é que o valor das populações são iguais.  \n```\n:::\n\n\nTeste T, usado para dois grupos independentes, primeiro existe se existe uma normalidade, dendencia ou independencia e se as variancias são homogeneas. (teste T não pareado), quem inventou o test t? student\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#teste T \n\n#longo para o largo (ver o formato antes tem que larogo)\nmg2 <- mg |> \n  pivot_wider(names_from = trat,\n              values_from = comp)\n\nteste1 <- t.test(mg2$Mg2, mg2$control, )\n\n#interpretação: o teste T - ligado ao erro padrão, a probabilidade é pequena pelo fato do p valor ter dado p-value = 2.423e-07 que nesse caso é menor que 0.5 rejeitando a hipotese nula. conclunido que o teste t esta correto. o intervalo de confiança é a diferença verdadeira entre as médias, dado pela ordem de montagem do teste. \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#testar a normalidade \nshapiro.test(mg2$control)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  mg2$control\nW = 0.93886, p-value = 0.5404\n```\n:::\n\n```{.r .cell-code}\n#testar a normalidade hipotese nula, dizendo que a distribuição é normal, maior que 0.5 normalidade. \n\nhist(mg2$control)\n```\n\n::: {.cell-output-display}\n![](Aula6e7_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#faz-se o histograma para saber se é normal \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#testar a normalidade para mg \nshapiro.test(mg2$Mg2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  mg2$Mg2\nW = 0.97269, p-value = 0.9146\n```\n:::\n\n```{.r .cell-code}\n#demosnta uma distribuição normal acima de 0.5\n\n\nhist(mg2$Mg2)\n```\n\n::: {.cell-output-display}\n![](Aula6e7_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#teste F que compara duas variancias\n\nvar.test(mg2$control, mg2$Mg2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tF test to compare two variances\n\ndata:  mg2$control and mg2$Mg2\nF = 0.67654, num df = 9, denom df = 9, p-value = 0.5698\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.1680428 2.7237436\nsample estimates:\nratio of variances \n         0.6765394 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nqqnorm(mg2$control)\nqqline(mg2$control)\n```\n\n::: {.cell-output-display}\n![](Aula6e7_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(report)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'report' was built under R version 4.3.3\n```\n:::\n\n```{.r .cell-code}\nreport(teste1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nEffect sizes were labelled following Cohen's (1988) recommendations.\n\nThe Welch Two Sample t-test testing the difference between mg2$Mg2 and\nmg2$control (mean of x = 10.52, mean of y = 15.68) suggests that the effect is\nnegative, statistically significant, and large (difference = -5.16, 95% CI\n[-6.49, -3.83], t(17.35) = -8.15, p < .001; Cohen's d = -3.65, 95% CI [-5.12,\n-2.14])\n```\n:::\n:::\n\n\n#Dois Grupos dependentes\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#para dois grupos test t, vai usar o test t pareado \n\n#importar o pacote de dados:\n\n\nescala <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1729131173\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nescala2 <- escala |> \n  dplyr::select(assessment, rater, acuracia) |> \n  pivot_wider(names_from = assessment,\n              values_from = acuracia)\nescala2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 10 × 3\n   rater Unaided Aided1\n   <chr>   <dbl>  <dbl>\n 1 A        0.81   0.91\n 2 B        0.72   0.91\n 3 C        0.4    0.91\n 4 D        0.82   0.96\n 5 E        0.75   0.96\n 6 F        0.45   0.9 \n 7 G        0.81   0.85\n 8 H        0.78   0.88\n 9 I        0.78   0.95\n10 J        0.5    0.94\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nescala |> \n  ggplot(aes(assessment, acuracia))+\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](Aula6e7_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#neste caso sugere falta de normalidade\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(escala2$Unaided)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  escala2$Unaided\nW = 0.7748, p-value = 0.007155\n```\n:::\n\n```{.r .cell-code}\nshapiro.test(escala2$Aided1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  escala2$Aided1\nW = 0.92852, p-value = 0.4335\n```\n:::\n\n```{.r .cell-code}\n#regeita a hipotese nula e aceita a falta de normalidade pq p-value = 0.007155. \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nvar.test(escala2$Unaided, escala2$Aided1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tF test to compare two variances\n\ndata:  escala2$Unaided and escala2$Aided1\nF = 20.978, num df = 9, denom df = 9, p-value = 0.000106\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n  5.210754 84.459185\nsample estimates:\nratio of variances \n          20.97847 \n```\n:::\n\n```{.r .cell-code}\n# se a variancia é homogenea ou não \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(escala2$Aided1, escala2$Unaided,\n       paired = TRUE,\n       var.equal = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPaired t-test\n\ndata:  escala2$Aided1 and escala2$Unaided\nt = 4.4214, df = 9, p-value = 0.001668\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n 0.1147647 0.3552353\nsample estimates:\nmean difference \n          0.235 \n```\n:::\n\n```{.r .cell-code}\n#teste de comparação de dois grupos de media, com 3 ou mais usa-se anova\n```\n:::\n\n\n#equivalente ao não parametico do teste t\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwilcox.test(escala2$Aided1,\n            escala2$Unaided, \n            paired = TRUE) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in wilcox.test.default(escala2$Aided1, escala2$Unaided, paired = TRUE):\nnão é possível computar o valor de p exato com o de desempate\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWilcoxon signed rank test with continuity correction\n\ndata:  escala2$Aided1 and escala2$Unaided\nV = 55, p-value = 0.005889\nalternative hypothesis: true location shift is not equal to 0\n```\n:::\n:::\n\n\n#3 ou mais grupos\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmicelial <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=959387827\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmicelial |> \n  ggplot(aes(especie, tcm))+\n  geom_jitter(width = 0.05)\n```\n\n::: {.cell-output-display}\n![](Aula6e7_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#menos de oito (6 pontos) - geom_jitter\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#anova \n\nm1 <- lm(tcm ~ especie -1 , data = micelial)\n\nanova(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: tcm\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nespecie    5 51.677 10.3354   552.2 < 2.2e-16 ***\nResiduals 25  0.468  0.0187                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = tcm ~ especie - 1, data = micelial)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.23667 -0.09667  0.01583  0.08833  0.28333 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \nespecieFasi  1.57167    0.05585   28.14  < 2e-16 ***\nespecieFaus  1.23667    0.05585   22.14  < 2e-16 ***\nespecieFcor  1.32167    0.05585   23.66  < 2e-16 ***\nespecieFgra  0.91167    0.05585   16.32 7.66e-15 ***\nespecieFmer  1.42667    0.05585   25.54  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1368 on 25 degrees of freedom\nMultiple R-squared:  0.991,\tAdjusted R-squared:  0.9892 \nF-statistic: 552.2 on 5 and 25 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\n#estudar a dif. entre os valores para a sabatina \n\n#segundo o teste da anova não há difrença estatistica entre as especies apenas numerica, todas com uma taxa micelial muito alta. \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntheme_set(theme_bw())\n\n#manter o mesmo tema \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(emmeans)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'emmeans' was built under R version 4.3.3\n```\n:::\n\n```{.r .cell-code}\nmedias1 <- emmeans(m1, ~ especie)\nmedias1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n especie emmean     SE df lower.CL upper.CL\n Fasi     1.572 0.0559 25    1.457     1.69\n Faus     1.237 0.0559 25    1.122     1.35\n Fcor     1.322 0.0559 25    1.207     1.44\n Fgra     0.912 0.0559 25    0.797     1.03\n Fmer     1.427 0.0559 25    1.312     1.54\n\nConfidence level used: 0.95 \n```\n:::\n\n```{.r .cell-code}\nlibrary(multcomp)\n\n\n\nlibrary(multcompView)\n\ncld(medias1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n especie emmean     SE df lower.CL upper.CL .group\n Fgra     0.912 0.0559 25    0.797     1.03  1    \n Faus     1.237 0.0559 25    1.122     1.35   2   \n Fcor     1.322 0.0559 25    1.207     1.44   2   \n Fmer     1.427 0.0559 25    1.312     1.54   23  \n Fasi     1.572 0.0559 25    1.457     1.69    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 5 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(m1$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula6e7_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(m1$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  m1$residuals\nW = 0.9821, p-value = 0.8782\n```\n:::\n\n```{.r .cell-code}\n#não rejeita a hipotese p-value = 0.8782.\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbartlett.test(tcm ~ especie, data = micelial)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  tcm by especie\nBartlett's K-squared = 4.4367, df = 4, p-value = 0.3501\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(DHARMa)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'DHARMa' was built under R version 4.3.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThis is DHARMa 0.4.6. For overview type '?DHARMa'. For recent changes, type news(package = 'DHARMa')\n```\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(m1))\n```\n\n::: {.cell-output-display}\n![](Aula6e7_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(performance)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'performance' was built under R version 4.3.3\n```\n:::\n\n```{.r .cell-code}\ncheck_normality(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.878).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.880).\n```\n:::\n\n```{.r .cell-code}\ncheck_model(m1)\n```\n\n::: {.cell-output-display}\n![](Aula6e7_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\nAula 7 - 24/04\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninseticida <- InsectSprays\n\nlibrary(tidyverse)\n\ninceticida <- InsectSprays\ninceticida |> \n  count(spray)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  spray  n\n1     A 12\n2     B 12\n3     C 12\n4     D 12\n5     E 12\n6     F 12\n```\n:::\n\n```{.r .cell-code}\n#anova com um fator ou seis niveis de fator \n```\n:::\n\n\nExploração do conjunto de dados - variavel numerica discreta\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninceticida |> \nggplot(aes(spray, count))+\n  geom_boxplot()+\n  geom_jitter(width = 0.05)\n```\n\n::: {.cell-output-display}\n![](Aula6e7_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#observando podemos ver que as variancias são heterogeneas, maior variabilidade(f), \n```\n:::\n\n\nAjusta a nova e trabalha com os residuos da anova e ai parte pa os testes, usando performace e darman.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- lm(count ~ spray, \n         data = inceticida)\nm1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = count ~ spray, data = inceticida)\n\nCoefficients:\n(Intercept)       sprayB       sprayC       sprayD       sprayE       sprayF  \n    14.5000       0.8333     -12.4167      -9.5833     -11.0000       2.1667  \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = count ~ spray, data = inceticida)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-8.333 -1.958 -0.500  1.667  9.333 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  14.5000     1.1322  12.807  < 2e-16 ***\nsprayB        0.8333     1.6011   0.520    0.604    \nsprayC      -12.4167     1.6011  -7.755 7.27e-11 ***\nsprayD       -9.5833     1.6011  -5.985 9.82e-08 ***\nsprayE      -11.0000     1.6011  -6.870 2.75e-09 ***\nsprayF        2.1667     1.6011   1.353    0.181    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.922 on 66 degrees of freedom\nMultiple R-squared:  0.7244,\tAdjusted R-squared:  0.7036 \nF-statistic:  34.7 on 5 and 66 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: count\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nspray      5 2668.8  533.77  34.702 < 2.2e-16 ***\nResiduals 66 1015.2   15.38                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(m1$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula6e7_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n\nshapiro mostra que significativo não é normal, se for significativo é normal.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(m1$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  m1$residuals\nW = 0.96006, p-value = 0.02226\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nqqnorm(m1$residuals)\nqqline(m1$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula6e7_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n:::\n\n\no que é mais importante a normalidade ou variancias homogeneas o que é a violação mais problematica?\n\nhomocedasticidade(?)\n\nQuando temos dados de contagem normalmente a raiz é uma boa opção.\n\nBartlett - test\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbartlett.test(count ~ spray,\n              data = inseticida)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  count by spray\nBartlett's K-squared = 25.96, df = 5, p-value = 9.085e-05\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_normality(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Non-normality of residuals detected (p = 0.022).\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p < .001).\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(DHARMa)\nplot(simulateResiduals(m1))\n```\n\n::: {.cell-output-display}\n![](Aula6e7_files/figure-html/unnamed-chunk-38-1.png){width=672}\n:::\n:::\n\n\nAlternativa 1 - transformação\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninseticida <- inseticida |> \n   mutate(count2 = sqrt(count))\n\ninseticida |> \n  ggplot(aes(spray, count2))+\n  geom_boxplot()+\n  geom_jitter()+\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](Aula6e7_files/figure-html/unnamed-chunk-39-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm2 <- lm (count2 ~ spray, data = inseticida)\n\nanova(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: count2\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nspray      5 88.438 17.6876  44.799 < 2.2e-16 ***\nResiduals 66 26.058  0.3948                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nsummary(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = count2 ~ spray, data = inseticida)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.24486 -0.39970 -0.01902  0.42661  1.40089 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   3.7607     0.1814  20.733  < 2e-16 ***\nsprayB        0.1160     0.2565   0.452    0.653    \nsprayC       -2.5158     0.2565  -9.807 1.64e-14 ***\nsprayD       -1.5963     0.2565  -6.223 3.80e-08 ***\nsprayE       -1.9512     0.2565  -7.606 1.34e-10 ***\nsprayF        0.2579     0.2565   1.006    0.318    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.6283 on 66 degrees of freedom\nMultiple R-squared:  0.7724,\tAdjusted R-squared:  0.7552 \nF-statistic:  44.8 on 5 and 66 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nhist(m2$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula6e7_files/figure-html/unnamed-chunk-40-1.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(m2$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  m2$residuals\nW = 0.98721, p-value = 0.6814\n```\n:::\n\n```{.r .cell-code}\nqqnorm(m2$residuals)\nqqline(m2$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula6e7_files/figure-html/unnamed-chunk-40-2.png){width=672}\n:::\n\n```{.r .cell-code}\nbartlett.test(count2 ~ spray,\n              data = inseticida)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  count2 by spray\nBartlett's K-squared = 3.7525, df = 5, p-value = 0.5856\n```\n:::\n\n```{.r .cell-code}\nlibrary(performance)\ncheck_normality(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.681).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.854).\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_normality(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.681).\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.854).\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(simulateResiduals(m2))\n```\n\n::: {.cell-output-display}\n![](Aula6e7_files/figure-html/unnamed-chunk-43-1.png){width=672}\n:::\n:::\n\n\n-   os testes adotados em m2 foram com normalidade podendo continuar com os testes.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    library(emmeans)\n    m2_medias <- emmeans(m2, ~ spray)\n    plot(m2_medias)\n    ```\n    \n    ::: {.cell-output-display}\n    ![](Aula6e7_files/figure-html/unnamed-chunk-44-1.png){width=672}\n    :::\n    \n    ```{.r .cell-code}\n    library(multcomp)\n    cld(m2_medias)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n     spray emmean    SE df lower.CL upper.CL .group\n     C       1.24 0.181 66    0.883     1.61  1    \n     E       1.81 0.181 66    1.447     2.17  12   \n     D       2.16 0.181 66    1.802     2.53   2   \n     A       3.76 0.181 66    3.399     4.12    3  \n     B       3.88 0.181 66    3.514     4.24    3  \n     F       4.02 0.181 66    3.656     4.38    3  \n    \n    Confidence level used: 0.95 \n    P value adjustment: tukey method for comparing a family of 6 estimates \n    significance level used: alpha = 0.05 \n    NOTE: If two or more means share the same grouping symbol,\n          then we cannot show them to be different.\n          But we also did not show them to be the same. \n    ```\n    :::\n    :::\n\n\nAlternativa 2 - teste não paramétrico - sem transformar\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(agricolae)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'agricolae' was built under R version 4.3.3\n```\n:::\n\n```{.r .cell-code}\nkruskal.test(count ~ spray, \n             data = inceticida)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  count by spray\nKruskal-Wallis chi-squared = 54.691, df = 5, p-value = 1.511e-10\n```\n:::\n\n```{.r .cell-code}\n#rejeita \n#ipotese nula é que as médias são iguais o que demonstra que rejeita - com 3 grupos ou mais \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm3 <- kruskal(inseticida$count,\n        inceticida$spray, \n        group = TRUE)\nm3\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$statistics\n     Chisq Df      p.chisq  t.value      MSD\n  54.69134  5 1.510845e-10 1.996564 8.462804\n\n$parameters\n            test p.ajusted           name.t ntr alpha\n  Kruskal-Wallis      none inceticida$spray   6  0.05\n\n$means\n  inseticida.count     rank      std  r Min Max   Q25  Q50   Q75\nA        14.500000 52.16667 4.719399 12   7  23 11.50 14.0 17.75\nB        15.333333 54.83333 4.271115 12   7  21 12.50 16.5 17.50\nC         2.083333 11.45833 1.975225 12   0   7  1.00  1.5  3.00\nD         4.916667 25.58333 2.503028 12   2  12  3.75  5.0  5.00\nE         3.500000 19.33333 1.732051 12   1   6  2.75  3.0  5.00\nF        16.666667 55.62500 6.213378 12   9  26 12.50 15.0 22.50\n\n$comparison\nNULL\n\n$groups\n  inseticida$count groups\nF         55.62500      a\nB         54.83333      a\nA         52.16667      a\nD         25.58333      b\nE         19.33333     bc\nC         11.45833      c\n\nattr(,\"class\")\n[1] \"group\"\n```\n:::\n\n```{.r .cell-code}\n#da a media dos tratamentos e um ranking para fazer a estatistica, calculando os agrupamentos. 3 grupos ranqueados. o não parametrico deu o mesmo resultado que o modelo transformado. podendo partir para a alternativa 3 assumindo que a distribuição é de acordo com os dados podendo ser poason (modelo linear generalizado - mais moderno)\n```\n:::\n\n\nAlternativa 3 - GLMs\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm4 <- glm(count ~ spray,\n          family = poisson, data = inseticida)\nsummary(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = count ~ spray, family = poisson, data = inseticida)\n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  2.67415    0.07581  35.274  < 2e-16 ***\nsprayB       0.05588    0.10574   0.528    0.597    \nsprayC      -1.94018    0.21389  -9.071  < 2e-16 ***\nsprayD      -1.08152    0.15065  -7.179 7.03e-13 ***\nsprayE      -1.42139    0.17192  -8.268  < 2e-16 ***\nsprayF       0.13926    0.10367   1.343    0.179    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 409.041  on 71  degrees of freedom\nResidual deviance:  98.329  on 66  degrees of freedom\nAIC: 376.59\n\nNumber of Fisher Scoring iterations: 5\n```\n:::\n\n```{.r .cell-code}\nanova(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table\n\nModel: poisson, link: log\n\nResponse: count\n\nTerms added sequentially (first to last)\n\n      Df Deviance Resid. Df Resid. Dev\nNULL                     71     409.04\nspray  5   310.71        66      98.33\n```\n:::\n\n```{.r .cell-code}\nlibrary(car)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'car' was built under R version 4.3.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: carData\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'carData' was built under R version 4.3.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'car'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:dplyr':\n\n    recode\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:purrr':\n\n    some\n```\n:::\n\n```{.r .cell-code}\nAnova(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II tests)\n\nResponse: count\n      LR Chisq Df Pr(>Chisq)    \nspray   310.71  5  < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(simulateResiduals(m4))\n```\n\n::: {.cell-output-display}\n![](Aula6e7_files/figure-html/unnamed-chunk-48-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm4_medias <- emmeans(m4, ~spray,\n                     type = \"response\")\ncld(m4_medias)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n spray  rate    SE  df asymp.LCL asymp.UCL .group\n C      2.08 0.417 Inf      1.41      3.08  1    \n E      3.50 0.540 Inf      2.59      4.74  12   \n D      4.92 0.640 Inf      3.81      6.35   2   \n A     14.50 1.099 Inf     12.50     16.82    3  \n B     15.33 1.130 Inf     13.27     17.72    3  \n F     16.67 1.179 Inf     14.51     19.14    3  \n\nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \nP value adjustment: tukey method for comparing a family of 6 estimates \nTests are performed on the log scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\nvalor original - observação resposta original\n\nanova - testo pressupostos\n\nalternativa 1 - trasformação\n\nbusca normalização\n\na2- não parametrico\n\na3- GLMs\n\nfaz tudo isso para cada variavel\n\n-   Transformação BOX-COX\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    library(MASS)\n    b <- boxcox(lm(inceticida$count+0.1 ~1))\n    ```\n    \n    ::: {.cell-output-display}\n    ![](Aula6e7_files/figure-html/unnamed-chunk-50-1.png){width=672}\n    :::\n    \n    ```{.r .cell-code}\n    lambda <- b$x[which.max(b$y)]\n    lambda\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    [1] 0.4242424\n    ```\n    :::\n    \n    ```{.r .cell-code}\n    inceticida$count3 <- (inceticida$count ^  lambda - 1) / lambda\n    inceticida$count3\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n     [1]  3.903635  3.024469  6.043993  4.864268  4.864268  4.407118  3.903635\n     [8]  6.557185  5.484274  6.043993  4.864268  4.640760  4.161975  5.484274\n    [15]  6.219699  4.161975  5.285168  4.864268  5.484274  5.484274  5.863153\n    [22]  6.219699  3.024469  4.640760 -2.357143  0.000000  3.024469  0.805831\n    [29]  1.399509  0.000000  0.805831  0.000000  1.399509 -2.357143  0.000000\n    [36]  1.887150  1.399509  2.308577  4.407118  2.683787  1.887150  1.399509\n    [43]  2.308577  2.308577  2.308577  2.308577  0.805831  1.887150  1.399509\n    [50]  2.308577  1.399509  2.308577  1.399509  2.683787  0.000000  0.000000\n    [57]  1.399509  0.805831  2.683787  1.887150  4.161975  3.629951  5.078760\n    [64]  6.390651  5.078760  5.285168  4.640760  3.903635  7.033117  7.033117\n    [71]  6.719601  4.640760\n    ```\n    :::\n    \n    ```{.r .cell-code}\n    #mandeira de tranformar \n    ```\n    :::\n\n\nuso do novo conjunto uma anova para dois fatores.\n\n#anova Fatorial\n\n\n::: {.cell}\n\n```{.r .cell-code}\nli <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=2023059672\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nli |> \n  ggplot(aes(factor(dose), severity, color = factor(dose)))+\n  geom_jitter(whidth = 0.1)+\n facet_wrap(~treat)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in geom_jitter(whidth = 0.1): Ignoring unknown parameters: `whidth`\n```\n:::\n\n::: {.cell-output-display}\n![](Aula6e7_files/figure-html/unnamed-chunk-52-1.png){width=672}\n:::\n:::\n\n\n#modelo fatorial (two-way anova)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmf <- lm(severity ~ treat * dose, \n         data = li)\nmf\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = severity ~ treat * dose, data = li)\n\nCoefficients:\n           (Intercept)       treatTebuconazole                    dose  \n                0.3728                 -0.3515                 -0.1613  \ntreatTebuconazole:dose  \n                0.1608  \n```\n:::\n\n```{.r .cell-code}\nanova(mf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: severity\n           Df   Sum Sq  Mean Sq F value    Pr(>F)    \ntreat       1 0.113232 0.113232  30.358 4.754e-05 ***\ndose        1 0.073683 0.073683  19.755 0.0004077 ***\ntreat:dose  1 0.072739 0.072739  19.502 0.0004326 ***\nResiduals  16 0.059678 0.003730                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n#demostra que a interassão é significativa, as doses estão diretamente ligadas aos tratamentos. \n```\n:::\n\n\ntestar as primicias\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(simulateResiduals(mf))\n```\n\n::: {.cell-output-display}\n![](Aula6e7_files/figure-html/unnamed-chunk-54-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#não teve problema \n```\n:::\n\n\nCompraçaõ de medias, dentro das linhas e dentro das colunas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmf_medias <- (mf ~ treat | dose)\n#cld(mf_medias)\n\n#comparou coluna \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# comprar as linhas \nmf_medias <- emmeans(mf, ~ dose | treat)\ncld (mf_medias)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntreat = Ionic liquid:\n dose emmean     SE df lower.CL upper.CL .group\n  2.0 0.0501 0.0273 16 -0.00781   0.1080  1    \n  0.5 0.2921 0.0273 16  0.23420   0.3500   2   \n\ntreat = Tebuconazole:\n dose emmean     SE df lower.CL upper.CL .group\n  2.0 0.0202 0.0273 16 -0.03768   0.0781  1    \n  0.5 0.0210 0.0273 16 -0.03690   0.0789  1    \n\nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n",
    "supporting": [
      "Aula6e7_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}